!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="8042daa9-256a-4a22-9b55-f1b25a2e4051",e._sentryDebugIdIdentifier="sentry-dbid-8042daa9-256a-4a22-9b55-f1b25a2e4051")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[679],{4601:(e,t,a)=>{a.d(t,{OJ:()=>v,Pl:()=>A,Pq:()=>g,Q5:()=>S,RK:()=>_,a0:()=>k,ag:()=>w,hm:()=>b,i9:()=>N,qP:()=>y,ue:()=>j});var s=a(80263),n=a(95043),l=a(28881),r=a(75189),i=a(20680),o=a(15601),c=a.n(o),d=a(53239),u=a(55966),m=a(51500),p=a(12644),h=a(93210),x=a(71139),f=a(78721);let b=(0,d.forwardRef)((e,t)=>{let{...a}=e;return(0,s.jsx)(u.Nt,{ref:t,...a,className:(0,m.cn)("w-full px-2 group",a.className)})}),g=(0,d.forwardRef)((e,t)=>{let{...a}=e;return(0,s.jsxs)(u.R6,{ref:t,...a,className:(0,m.cn)("w-full flex gap-1 items-center group px-3 text-sm font-normal font-mono uppercase text-lighter tracking-wide",a.className),children:[(0,s.jsx)(n.A,{className:"transition-all text-foreground-muted group-data-[state=open]:rotate-90",size:16,strokeWidth:1.5}),(0,s.jsx)("span",{className:"group-hover:not-disabled:text-foreground",children:a.title})]})}),y=(0,d.forwardRef)((e,t)=>{let{...a}=e;return(0,s.jsx)(u.Ke,{ref:t,...a,className:(0,m.cn)("w-full flex flex-col gap-0",a.className)})}),v=(0,d.forwardRef)((e,t)=>(0,s.jsx)("div",{ref:t,...e,className:(0,m.cn)("h-px bg-border-muted",e.className)})),j=(0,d.forwardRef)((e,t)=>{let{className:a,isActive:n,forceHoverState:l,...r}=e;return(0,s.jsx)(c(),{ref:t,...r,"aria-current":n,className:(0,m.cn)("text-sm","h-7 pl-3 pr-2","flex items-center justify-between rounded-md group relative",n?"bg-selection":"hover:bg-surface-200",l&&"bg-surface-200",n?"text-foreground":"text-foreground-light hover:text-foreground",a)})}),w=(0,d.forwardRef)((e,t)=>{let{isActive:a=!0,forceHoverState:n,isPreview:l,isOpened:r=!0,...i}=e;return(0,s.jsxs)(c(),{ref:t,...i,"aria-current":a,className:(0,m.cn)((0,p.u2)({isSelected:a&&!l,isOpened:r&&!l,isPreview:l}),"px-4",i.className),children:[!l&&a&&(0,s.jsx)("div",{className:"absolute left-0 h-full w-0.5 bg-foreground"}),i.children]})}),k=(0,d.forwardRef)((e,t)=>(0,s.jsx)("div",{ref:t,...e,className:(0,m.cn)("flex px-2 gap-2 items-center",e.className)})),_=(0,d.forwardRef)((e,t)=>{let{children:a,isLoading:n=!1,...i}=e;return(0,s.jsxs)("label",{htmlFor:i.name,className:"relative w-full",children:[(0,s.jsx)("span",{className:"sr-only",children:i["aria-labelledby"]}),(0,s.jsx)(h.p,{ref:t,type:"text",className:(0,m.cn)("h-[32px] md:h-[28px] w-full","text-base md:text-xs","pl-7","pr-7","w-full","rounded",i.className),...i}),a,n?(0,s.jsx)(l.A,{className:"animate-spin absolute left-2 text-foreground-muted",style:{top:7},size:14,strokeWidth:1.5}):(0,s.jsx)(r.A,{className:"absolute left-2 top-2 text-foreground-muted",size:14,strokeWidth:1.5})]})}),N=(0,d.forwardRef)((e,t)=>{let{value:a,onValueChange:n,contentClassName:l,triggerClassName:r,...o}=e;return(0,s.jsxs)(x.rI,{modal:!1,children:[(0,s.jsxs)(f.m_,{delayDuration:0,children:[(0,s.jsx)(x.ty,{asChild:!0,className:(0,m.cn)("absolute right-1 top-[.4rem] md:top-[.3rem]","text-foreground transition-colors hover:text-foreground data-[state=open]:text-foreground",r),children:(0,s.jsx)(f.k$,{children:(0,s.jsx)(i.A,{size:18,strokeWidth:1})})}),(0,s.jsx)(f.ZI,{side:"bottom",children:"Sort By"})]}),(0,s.jsx)(x.SQ,{side:"bottom",align:"end",className:(0,m.cn)("w-48",l),children:(0,s.jsx)(x.Hr,{value:a,onValueChange:n,children:o.children})})]})}),A=(0,d.forwardRef)((e,t)=>(0,s.jsx)(x.Ht,{ref:t,...e})),S=(0,d.forwardRef)((e,t)=>{let{illustration:a,title:n,description:l,actions:r,...i}=e;return(0,s.jsx)("div",{ref:t,...i,className:(0,m.cn)("border border-muted bg-surface-100 dark:bg-surface-75 flex flex-col gap-y-3 items-center justify-center rounded-md px-5 py-4",i.className),children:(0,s.jsxs)("div",{className:"w-full flex flex-col gap-y-1 items-center",children:[a,n&&(0,s.jsx)("p",{className:"text-xs text-foreground-light",children:n}),l&&(0,s.jsx)("p",{className:"text-xs text-foreground-lighter text-center",children:l}),r&&(0,s.jsx)("div",{className:"mt-2",children:r}),i.children]})})})},5588:(e,t,a)=>{a.d(t,{P:()=>r});var s=a(77569),n=a(98832),l=a(91435);let r=()=>{var e,t;let{project:a}=(0,n.Om)(),{data:r,isLoading:i}=(0,l.z)({projectRef:null==a?void 0:a.ref,connectionString:null==a?void 0:a.connectionString}),o=s.o.find(e=>"iceberg_wrapper"===e.id);if(!o||"wrapper"!==o.type)return"not-found";let c=o.meta,d=null==r?void 0:r.find(e=>"wrappers"===e.name),u=!!(null==d?void 0:d.installed_version),m=(null!=(e=null==d?void 0:d.installed_version)?e:"")>=(null!=(t=null==c?void 0:c.minimumExtensionVersion)?t:"");return i?"loading":u?m?"installed":"needs-upgrade":"not-installed"}},47221:(e,t,a)=>{a.d(t,{Z:()=>h});var s=a(60045),n=a(52793),l=a.n(n),r=a(23229),i=a(54498),o=a(98832),c=a(76291),d=a(67575),u=a(66427),m=a(75019),p=a(39719);let h=()=>{var e,t,a,n,h,x;let{project:f}=(0,o.Om)(),{data:b}=(0,c.I)({projectRef:null==f?void 0:f.ref,reveal:!0}),{secretKey:g,serviceKey:y}=(0,c.x)(b),{data:v}=(0,d.G)({projectRef:null==f?void 0:f.ref}),j=null!=(n=null==v||null==(e=v.app_config)?void 0:e.protocol)?n:"https",w=(null==v||null==(t=v.app_config)?void 0:t.storage_endpoint)||(null==v||null==(a=v.app_config)?void 0:a.endpoint),k=null!=(x=null!=(h=null==g?void 0:g.api_key)?h:null==y?void 0:y.api_key)?x:"SUPABASE_CLIENT_API_KEY",_=r.V.find(e=>"iceberg_wrapper"===e.name),N=(0,m.SE)(s.aG.STORAGE_ADMIN_WRITE,"*"),{mutateAsync:A,isLoading:S}=(0,p.S)(),{mutateAsync:C,isLoading:z}=(0,u.m_)();return{mutateAsync:async e=>{var t,a;let{bucketName:s}=e,n=await A({projectRef:null==f?void 0:f.ref,description:"".concat(l()(s),"_keys")}),r="".concat(l()(s),"_fdw"),o={projectRef:null==f?void 0:f.ref,connectionString:null==f?void 0:f.connectionString,wrapperMeta:_,formState:{wrapper_name:r,server_name:"".concat(r,"_server"),vault_aws_access_key_id:null==n?void 0:n.access_key,vault_aws_secret_access_key:null==n?void 0:n.secret_key,vault_token:k,warehouse:s,"s3.endpoint":(0,i.yO)(null!=(t=null==f?void 0:f.ref)?t:"",j,w),catalog_uri:(0,i.Uj)(null!=(a=null==f?void 0:f.ref)?a:"",j,w)},mode:"skip",tables:[],sourceSchema:"",targetSchema:""};await C(o)},isLoading:z||S,hasPermission:N}}},60680:(e,t,a)=>{a.d(t,{Ay:()=>i});var s=a(80263),n=a(90709);a(53239);var l=a(70800);let r=e=>{let{open:t,children:a,className:l,...r}=e;return(0,s.jsx)(n.bL,{asChild:r.asChild,defaultOpen:r.defaultOpen,open:t,onOpenChange:r.onOpenChange,disabled:r.disabled,className:l,"data-sentry-element":"unknown","data-sentry-component":"Collapsible","data-sentry-source-file":"Collapsible.tsx",children:a})};r.Trigger=function(e){let{children:t,asChild:a}=e;return(0,s.jsx)(n.l9,{asChild:a,"data-sentry-element":"unknown","data-sentry-component":"Trigger","data-sentry-source-file":"Collapsible.tsx",children:t})},r.Content=function(e){let{asChild:t,children:a,className:r}=e,i=(0,l.A)("collapsible");return(0,s.jsx)(n.UC,{asChild:t,className:[i.content,r].join(" "),"data-sentry-element":"unknown","data-sentry-component":"Content","data-sentry-source-file":"Collapsible.tsx",children:a})};let i=r},77569:(e,t,a)=>{a.d(t,{o:()=>A});var s=a(80263),n=a(24863),l=a(85563),r=a(5010),i=a(36975),o=a(59350),c=a(49434),d=a.n(c),u=a(16426),m=a.n(u),p=a(90437),h=a(63492),x=a(51500),f=a(15601),b=a.n(f),g=a(5483),y=a(40022),v=a(47142);let j=e=>{let{minimumVersion:t="15.6"}=e,a=(0,g.KT)();return(0,s.jsxs)(v.Z,{type:"warning",className:"mt-4",title:"Database upgrade needed",childProps:{description:{className:"flex flex-col gap-y-2"}},"data-sentry-element":"Admonition","data-sentry-component":"UpgradeDatabaseAlert","data-sentry-source-file":"UpgradeDatabaseAlert.tsx",children:[(0,s.jsx)("div",{className:"prose text-sm max-w-full",children:(0,s.jsxs)("p",{children:["This integration requires the ",(0,s.jsx)("code",{children:"pgmq"})," extension which is not available on this version of Postgres. The extension is available on version ",t," and higher."]})}),(0,s.jsx)(y.$,{color:"primary",className:"w-fit","data-sentry-element":"Button","data-sentry-source-file":"UpgradeDatabaseAlert.tsx",children:(0,s.jsx)(b(),{href:"/project/".concat(null==a?void 0:a.ref,"/settings/infrastructure"),"data-sentry-element":"Link","data-sentry-source-file":"UpgradeDatabaseAlert.tsx",children:"Upgrade database"})})]})};var w=a(23229);let k=()=>(0,s.jsx)("div",{className:"p-10","data-sentry-component":"Loading","data-sentry-source-file":"Integrations.constants.tsx",children:(0,s.jsx)(p.y,{"data-sentry-element":"GenericSkeletonLoader","data-sentry-source-file":"Integrations.constants.tsx"})}),_={name:"Supabase",websiteUrl:"https://supabase.com"},N=[{id:"queues",type:"postgres_extension",requiredExtensions:["pgmq"],missingExtensionsAlert:(0,s.jsx)(j,{minimumVersion:"15.6.1.143"}),name:"Queues",icon:function(){let{className:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.jsx)(n.A,{className:(0,x.cn)("inset-0 p-2 text-black w-full h-full",e),...t})},description:"Lightweight message queue in Postgres",docsUrl:"https://github.com/tembo-io/pgmq",author:{name:"pgmq",websiteUrl:"https://github.com/tembo-io/pgmq"},navigation:[{route:"overview",label:"Overview"},{route:"queues",label:"Queues",hasChild:!0,childIcon:(0,s.jsx)(n.A,{size:12,strokeWidth:1.5,className:(0,x.cn)("text-foreground w-full h-full")})},{route:"settings",label:"Settings"}],navigate:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"overview",s=arguments.length>2?arguments[2]:void 0;if(s)return d()(()=>Promise.all([a.e(4986),a.e(89),a.e(726),a.e(3730),a.e(2981),a.e(4849),a.e(1680),a.e(9014),a.e(7795),a.e(4444),a.e(6692),a.e(6616),a.e(1444),a.e(3064),a.e(8079)]).then(a.bind(a,40814)).then(e=>e.QueueTab),{loadableGenerated:{webpack:()=>[40814]},loading:k});switch(t){case"overview":return d()(()=>Promise.all([a.e(726),a.e(6616),a.e(2621),a.e(1793)]).then(a.bind(a,37138)).then(e=>e.QueuesOverviewTab),{loadableGenerated:{webpack:()=>[37138]},loading:k});case"queues":return d()(()=>Promise.all([a.e(2981),a.e(6616),a.e(3386)]).then(a.bind(a,53386)).then(e=>e.QueuesTab),{loadableGenerated:{webpack:()=>[53386]},loading:k});case"settings":return d()(()=>Promise.all([a.e(2981),a.e(6616),a.e(7119)]).then(a.bind(a,47119)).then(e=>e.QueuesSettings),{loadableGenerated:{webpack:()=>[47119]},loading:k})}return null}},{id:"cron",type:"postgres_extension",requiredExtensions:["pg_cron"],name:"Cron",icon:function(){let{className:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.jsx)(l.A,{className:(0,x.cn)("inset-0 p-2 text-black w-full h-full",e),...t})},description:"Schedule recurring Jobs in Postgres.",docsUrl:"https://github.com/citusdata/pg_cron",author:{name:"Citus Data",websiteUrl:"https://github.com/citusdata/pg_cron"},navigation:[{route:"overview",label:"Overview"},{route:"jobs",label:"Jobs",hasChild:!0,childIcon:(0,s.jsx)(r.A,{size:12,strokeWidth:1.5,className:(0,x.cn)("text-foreground w-full h-full")})}],navigate:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"overview",s=arguments.length>2?arguments[2]:void 0;if(s)return d()(()=>Promise.all([a.e(8199),a.e(726),a.e(8274),a.e(9014),a.e(1486),a.e(1715),a.e(7141),a.e(7233)]).then(a.bind(a,18344)).then(e=>e.PreviousRunsTab),{loadableGenerated:{webpack:()=>[18344]},loading:k});switch(t){case"overview":return d()(()=>Promise.all([a.e(726),a.e(2621),a.e(6631)]).then(a.bind(a,68316)).then(e=>e.IntegrationOverviewTab),{loadableGenerated:{webpack:()=>[68316]},loading:k});case"jobs":return d()(()=>Promise.all([a.e(4986),a.e(89),a.e(8199),a.e(726),a.e(3730),a.e(2981),a.e(4849),a.e(9014),a.e(7795),a.e(1486),a.e(8664),a.e(1715),a.e(2621),a.e(7141),a.e(7246)]).then(a.bind(a,24344)).then(e=>e.CronjobsTab),{loadableGenerated:{webpack:()=>[24344]},loading:k})}return null}},{id:"vault",type:"postgres_extension",requiredExtensions:["supabase_vault"],missingExtensionsAlert:(0,s.jsx)(j,{}),name:"Vault",status:"alpha",icon:function(){let{className:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.jsx)(i.A,{className:(0,x.cn)("inset-0 p-2 text-black w-full h-full",e),...t})},description:"Application level encryption for your project",docsUrl:"https://supabase.com/docs",author:_,navigation:[{route:"overview",label:"Overview"},{route:"secrets",label:"Secrets"}],navigate:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"overview";switch(arguments.length>2&&arguments[2],t){case"overview":return d()(()=>Promise.all([a.e(726),a.e(2621),a.e(6631)]).then(a.bind(a,68316)).then(e=>e.IntegrationOverviewTab),{loadableGenerated:{webpack:()=>[68316]},loading:k});case"secrets":return d()(()=>Promise.all([a.e(726),a.e(670),a.e(316)]).then(a.bind(a,30316)).then(e=>e.SecretsManagement),{loadableGenerated:{webpack:()=>[30316]},loading:k})}return null}},{id:"webhooks",type:"postgres_extension",name:"Database Webhooks",icon:function(){let{className:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.jsx)(o.A,{className:(0,x.cn)("inset-0 p-2 text-black w-full h-full",e),...t})},description:"Send real-time data from your database to another system when a table event occurs",docsUrl:"https://supabase.com/docs",author:_,requiredExtensions:[],navigation:[{route:"overview",label:"Overview"},{route:"webhooks",label:"Webhooks"}],navigate:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"overview";switch(arguments.length>2&&arguments[2],t){case"overview":return d()(()=>Promise.all([a.e(726),a.e(2621),a.e(4039)]).then(a.bind(a,940)).then(e=>e.WebhooksOverviewTab),{loadableGenerated:{webpack:()=>[940]},loading:k});case"webhooks":return d()(()=>Promise.all([a.e(726),a.e(4280),a.e(2981),a.e(6616),a.e(670),a.e(9434)]).then(a.bind(a,59434)).then(e=>e.WebhooksListTab),{loadableGenerated:{webpack:()=>[59434]},loading:k})}return null}},{id:"graphiql",type:"postgres_extension",requiredExtensions:["pg_graphql"],name:"GraphQL",icon:function(){let{className:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.jsx)(m(),{fill:!0,src:"".concat(h.o2,"/img/graphql.svg"),alt:"GraphiQL",className:(0,x.cn)("p-2",e),...t})},description:"Run GraphQL queries through our interactive in-browser IDE",docsUrl:"https://supabase.com/docs",author:_,navigation:[{route:"overview",label:"Overview"},{route:"graphiql",label:"GraphiQL"}],navigate:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"overview";switch(arguments.length>2&&arguments[2],t){case"overview":return d()(()=>Promise.all([a.e(726),a.e(2621),a.e(6631)]).then(a.bind(a,68316)).then(e=>e.IntegrationOverviewTab),{loadableGenerated:{webpack:()=>[68316]},loading:k});case"graphiql":return d()(()=>Promise.all([a.e(5708),a.e(4986),a.e(726),a.e(3730),a.e(1680),a.e(9014),a.e(6692),a.e(4136),a.e(1444),a.e(5957),a.e(2621),a.e(9459)]).then(a.bind(a,51044)).then(e=>e.GraphiQLTab),{loadableGenerated:{webpack:()=>[51044]},loading:k})}return null}}],A=[...w.V.map(e=>({id:e.name,type:"wrapper",name:"".concat(e.label," Wrapper"),icon:function(){let{className:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.jsx)(m(),{fill:!0,src:e.icon,alt:e.name,className:(0,x.cn)("p-2",t),...a})},requiredExtensions:["wrappers","supabase_vault"],description:e.description,docsUrl:e.docsUrl,meta:e,author:_,navigation:[{route:"overview",label:"Overview"},{route:"wrappers",label:"Wrappers"}],navigate:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"overview";switch(arguments.length>2&&arguments[2],t){case"overview":return d()(()=>Promise.all([a.e(4986),a.e(726),a.e(3730),a.e(2621),a.e(6333),a.e(8989)]).then(a.bind(a,79142)).then(e=>e.WrapperOverviewTab),{loadableGenerated:{webpack:()=>[79142]},loading:k});case"wrappers":return d()(()=>Promise.all([a.e(4986),a.e(726),a.e(3730),a.e(6333),a.e(5794)]).then(a.bind(a,57357)).then(e=>e.WrappersTab),{loadableGenerated:{webpack:()=>[57357]},loading:k})}return null}})),...N]},80679:(e,t,a)=>{a.d(t,{A:()=>eC});var s=a(80263),n=a(52361),l=a(78098),r=a(60045),i=a(56404),o=a(11192),c=a(18687),d=a(15601),u=a.n(d),m=a(24400),p=a(53239),h=a(90478),x=a(32981),f=a(52793),b=a.n(f),g=a(72259),y=a(87494),v=a(73969),j=a(39353),w=a(5588),k=a(73934),_=a(12578),N=a(85278),A=a(32144),S=a(80251),C=a(65172),z=a(33793);async function E(e){let{projectRef:t,id:a,type:s,isPublic:n,file_size_limit:l,allowed_mime_types:r}=e;if(!t)throw Error("projectRef is required");if(!a)throw Error("Bucket name is required");let i={id:a,type:s,public:n};"STANDARD"===s&&(l&&(i.file_size_limit=l),r&&(i.allowed_mime_types=r));let{data:o,error:c}=await (0,C.bE)("/platform/storage/{ref}/buckets",{params:{path:{ref:t}},body:i});return c&&(0,C.H4)(c),o}let T=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,A.jE)();return(0,S.n)(e=>E(e),{async onSuccess(t,a,n){let{projectRef:l}=a;await s.invalidateQueries(z.w.buckets(l)),await (null==e?void 0:e(t,a,n))},async onError(e,a,s){void 0===t?v.oR.error("Failed to create bucket: ".concat(e.message)):t(e,a,s)},...a})};var M=a(47221),R=a(57132),I=a(23385),B=a(63492),P=a(67120),L=a(47452),O=a(93210),D=a(4870),q=a(86254),G=a(37394),F=a(60680),W=a(51500),U=a(26860),Q=a(19428),Y=a(1012),J=a(40022),V=a(47142),K=a(61395),$=a(54498);let H=j.Ay.object({name:j.Ay.string().trim().min(1,"Please provide a name for your bucket").regex(/^[a-z0-9.-]+$/,"The name of the bucket must only contain lowercase letters, numbers, dots, and hyphens").refine(e=>!e.endsWith(" "),"The name of the bucket cannot end with a whitespace").refine(e=>"public"!==e,'"public" is a reserved name. Please choose another name'),type:j.Ay.enum(["STANDARD","ANALYTICS"]).default("STANDARD"),public:j.Ay.boolean().default(!1),has_file_size_limit:j.Ay.boolean().default(!1),formatted_size_limit:j.Ay.coerce.number().min(0,"File size upload limit has to be at least 0").default(0),allowed_mime_types:j.Ay.string().trim().default("")}),Z=e=>{var t,a,n;let{visible:l,onClose:r}=e,{ref:i}=(0,h.g)(),o=(0,I.a)(),{mutate:c}=(0,R.h)(),d=(0,m.useRouter)(),{mutateAsync:f,isLoading:j}=T({onError:()=>{}}),{mutateAsync:A,isLoading:S}=(0,M.Z)(),{data:C}=(0,N.I)({projectRef:i},{enabled:B.pe}),{value:z,unit:E}=(0,$.Jb)(null!=(n=null==C?void 0:C.fileSizeLimit)?n:0),Z="".concat(z," ").concat(E),[X,ee]=(0,p.useState)(k.s2.BYTES),[et,ea]=(0,p.useState)(!1),es=(0,y.mN)({resolver:(0,x.u)(H),defaultValues:{name:"",public:!1,type:"STANDARD",has_file_size_limit:!1,formatted_size_limit:0,allowed_mime_types:""}}),en=b()(es.watch("name")),el=es.watch("public"),er="STANDARD"===es.watch("type"),ei=es.watch("has_file_size_limit"),eo=es.watch("formatted_size_limit"),ec=(0,w.P)(),ed=async e=>{if(!i)return console.error("Project ref is required");if("ANALYTICS"===e.type&&!eu)return void v.oR.error("The Analytics catalog feature is not enabled for your project. Please contact support to enable it.");try{var t;let a=e.has_file_size_limit?(0,$.OG)(e.formatted_size_limit,X):void 0,s=e.allowed_mime_types.length>0?e.allowed_mime_types.split(",").map(e=>e.trim()):void 0;await f({projectRef:i,id:e.name,type:e.type,isPublic:e.public,file_size_limit:a,allowed_mime_types:s}),c({action:"storage_bucket_created",properties:{bucketType:e.type},groups:{project:null!=i?i:"Unknown",organization:null!=(t=null==o?void 0:o.slug)?t:"Unknown"}}),"ANALYTICS"===e.type&&"installed"===ec&&await A({bucketName:e.name}),v.oR.success("Successfully created bucket ".concat(e.name)),d.push("/project/".concat(i,"/storage/buckets/").concat(e.name)),r()}catch(e){v.oR.error("Failed to create bucket: ".concat(e.message))}};(0,p.useEffect)(()=>{l&&(es.reset(),ee(k.s2.BYTES),ea(!1))},[l,es]);let eu=null==C||null==(a=C.features)||null==(t=a.icebergCatalog)?void 0:t.enabled;return(0,s.jsx)(P.A,{hideFooter:!0,visible:l,size:"medium",header:"Create storage bucket",onCancel:()=>r(),"data-sentry-element":"Modal","data-sentry-component":"CreateBucketModal","data-sentry-source-file":"CreateBucketModal.tsx",children:(0,s.jsx)(L.lV,{...es,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"CreateBucketModal.tsx",children:(0,s.jsxs)("form",{onSubmit:es.handleSubmit(ed),children:[(0,s.jsxs)(P.A.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"CreateBucketModal.tsx",children:[(0,s.jsx)(L.zB,{control:es.control,name:"name",render:e=>{let{field:t}=e;return(0,s.jsx)(K.M,{label:"Name of bucket",labelOptional:"Buckets cannot be renamed once created.",description:"Only lowercase letters, numbers, dots, and hyphens",layout:"vertical",children:(0,s.jsx)(L.MJ,{children:(0,s.jsx)(O.p,{...t,placeholder:"Enter bucket name"})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreateBucketModal.tsx"}),(0,s.jsx)("div",{className:"flex flex-col gap-y-2 mt-6",children:(0,s.jsx)(L.zB,{control:es.control,name:"type",render:e=>{let{field:t}=e;return(0,s.jsx)(K.M,{children:(0,s.jsx)(L.MJ,{children:(0,s.jsxs)(D.s,{id:"type",onValueChange:e=>t.onChange(e),value:t.value,children:[(0,s.jsx)(D.v,{value:"STANDARD",id:"STANDARD",label:"Standard bucket",showIndicator:!1,children:(0,s.jsx)("div",{className:"flex  gap-x-5",children:(0,s.jsx)("div",{className:"flex flex-col",children:(0,s.jsx)("p",{className:"text-foreground-light text-left",children:"Compatible with S3 buckets."})})})}),B.pe&&(0,s.jsxs)(D.v,{value:"ANALYTICS",id:"ANALYTICS",label:"Analytics bucket",showIndicator:!1,disabled:!eu,children:[(0,s.jsx)("div",{className:"flex  gap-x-5",children:(0,s.jsx)("div",{className:"flex flex-col",children:(0,s.jsx)("p",{className:"text-foreground-light text-left",children:"Stores Iceberg files and is optimized for analytical workloads."})})}),!eu&&(0,s.jsxs)("div",{className:"w-full flex gap-x-2 py-2 items-center",children:[(0,s.jsx)(q.id,{}),(0,s.jsxs)("span",{className:"text-xs text-left text-foreground-lighter",children:["This is currently in alpha and not enabled for your project. Sign up"," ",(0,s.jsx)(_.g,{href:"https://forms.supabase.com/analytics-buckets",children:"here"}),"."]})]})]})]})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreateBucketModal.tsx"})})]}),(0,s.jsx)(P.A.Separator,{"data-sentry-element":"unknown","data-sentry-source-file":"CreateBucketModal.tsx"}),er?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(P.A.Content,{className:"!px-0 !pb-0",children:(0,s.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,s.jsx)(L.zB,{control:es.control,name:"public",render:e=>{let{field:t}=e;return(0,s.jsx)(K.M,{className:"px-5",children:(0,s.jsx)(L.MJ,{children:(0,s.jsx)(G.A,{id:"public",checked:t.value,onChange:t.onChange,layout:"flex",label:"Public bucket",descriptionText:"Anyone can read any object without any authorization"})})})}}),el&&(0,s.jsxs)(V.Z,{type:"warning",className:"rounded-none border-x-0 border-b-0 mb-0 [&>div>p]:!leading-normal",title:"Public buckets are not protected",children:[(0,s.jsx)("p",{className:"mb-2",children:"Users can read objects in public buckets without any authorization."}),(0,s.jsx)("p",{children:"Row level security (RLS) policies are still required for other operations such as object uploads and deletes."})]})]})}),(0,s.jsx)(P.A.Separator,{}),(0,s.jsxs)(F.Ay,{open:et,onOpenChange:()=>ea(!et),children:[(0,s.jsx)(F.Ay.Trigger,{asChild:!0,children:(0,s.jsxs)("div",{className:"w-full cursor-pointer py-3 px-5 flex items-center justify-between",children:[(0,s.jsx)("p",{className:"text-sm",children:"Additional restrictions"}),(0,s.jsx)(g.A,{size:18,strokeWidth:2,className:(0,W.cn)("text-foreground-light",et&&"rotate-180")})]})}),(0,s.jsx)(F.Ay.Content,{className:"py-4",children:(0,s.jsxs)("div",{className:"w-full space-y-5 px-5",children:[(0,s.jsxs)("div",{className:"space-y-5",children:[(0,s.jsx)(L.zB,{control:es.control,name:"has_file_size_limit",render:e=>{let{field:t}=e;return(0,s.jsx)(K.M,{children:(0,s.jsx)(L.MJ,{children:(0,s.jsx)(G.A,{id:"has_file_size_limit",checked:t.value,onChange:t.onChange,layout:"flex",label:"Restrict file upload size for bucket",descriptionText:"Prevent uploading of file sizes greater than a specified limit"})})})}}),ei&&(0,s.jsxs)("div",{className:"grid grid-cols-12 col-span-12 gap-x-2 gap-y-1",children:[(0,s.jsx)("div",{className:"col-span-8",children:(0,s.jsx)(L.zB,{control:es.control,name:"formatted_size_limit",render:e=>{let{field:t}=e;return(0,s.jsxs)(K.M,{children:[(0,s.jsx)(L.MJ,{children:(0,s.jsx)(O.p,{type:"number",step:1,...t,onKeyPress:e=>{(e.charCode<48||e.charCode>57)&&e.preventDefault()}})}),(0,s.jsxs)("span",{className:"text-foreground-light text-xs",children:["Equivalent to"," ",(0,$.OG)(eo,X).toLocaleString()," ","bytes."]})]})}})}),(0,s.jsx)("div",{className:"col-span-4",children:(0,s.jsx)(U.A,{id:"size_limit_units",value:X,onChange:ee,children:Object.values(k.s2).map(e=>(0,s.jsx)(U.A.Option,{label:e,value:e,children:(0,s.jsx)("div",{children:e})},e))})}),B.pe&&(0,s.jsx)("div",{className:"col-span-12",children:(0,s.jsxs)("p",{className:"text-foreground-light text-sm",children:["Note: Individual bucket uploads will still be capped at the"," ",(0,s.jsx)(u(),{href:"/project/".concat(i,"/settings/storage"),className:"font-bold underline",children:"global upload limit"})," ","of ",Z]})})]})]}),(0,s.jsx)(L.zB,{control:es.control,name:"allowed_mime_types",render:e=>{let{field:t}=e;return(0,s.jsx)(K.M,{label:"Allowed MIME types",labelOptional:"Comma separated values",description:"Wildcards are allowed, e.g. image/*. Leave blank to allow any MIME type.",layout:"vertical",children:(0,s.jsx)(L.MJ,{children:(0,s.jsx)(O.p,{...t,placeholder:"e.g image/jpeg, image/png, audio/mpeg, video/mp4, etc"})})})}})]})})]})]}):(0,s.jsx)(P.A.Content,{children:"installed"===ec?(0,s.jsxs)(Q.J,{className:"text-foreground-lighter leading-1 flex flex-col gap-y-2",children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{children:"Supabase will setup a "}),(0,s.jsxs)("a",{href:"".concat(B.o2,"/project/").concat(i,"/integrations/iceberg_wrapper/overview"),target:"_blank",className:"underline text-foreground-light",children:["foreign data wrapper",en&&(0,s.jsxs)("span",{className:"text-brand",children:[" ","".concat(en,"_fdw")]})]}),(0,s.jsxs)("span",{children:[" ","for easier access to the data. This action will also create"," ",(0,s.jsxs)("a",{href:"".concat(B.o2,"/project/").concat(i,"/storage/access-keys"),target:"_blank",className:"underline text-foreground-light",children:["S3 Access Keys",en&&(0,s.jsxs)(s.Fragment,{children:[" ","named ",(0,s.jsxs)("span",{className:"text-brand",children:[" ","".concat(en,"_keys")]})]})]}),(0,s.jsx)("span",{children:" and "}),(0,s.jsxs)("a",{href:"".concat(B.o2,"/project/").concat(i,"/integrations/vault/secrets"),target:"_blank",className:"underline text-foreground-light",children:["four Vault Secrets",en&&(0,s.jsxs)(s.Fragment,{children:[" ","prefixed with"," ",(0,s.jsxs)("span",{className:"text-brand",children:[" ","".concat(en,"_vault_")]})]})]}),"."]})]}),(0,s.jsxs)("p",{children:["As a final step, you'll need to create an"," ",(0,s.jsx)("span",{className:"text-foreground-light",children:"Iceberg namespace"})," before you connect the Iceberg data to your database."]})]}):(0,s.jsxs)(Y.Fc,{variant:"warning",children:[(0,s.jsx)(q.id,{}),(0,s.jsx)(Y.XL,{children:"You need to install the Iceberg wrapper extension to connect your Analytic bucket to your database."}),(0,s.jsx)(Y.TN,{className:"flex flex-col gap-y-2",children:(0,s.jsxs)("p",{children:["You need to install the ",(0,s.jsx)("span",{className:"text-brand",children:"wrappers"})," extension (with the minimum version of ",(0,s.jsx)("span",{children:"0.5.3"}),") if you want to connect your Analytics bucket to your database."]})})]})}),(0,s.jsx)(P.A.Separator,{"data-sentry-element":"unknown","data-sentry-source-file":"CreateBucketModal.tsx"}),(0,s.jsxs)(P.A.Content,{className:"flex items-center space-x-2 justify-end","data-sentry-element":"unknown","data-sentry-source-file":"CreateBucketModal.tsx",children:[(0,s.jsx)(J.$,{type:"default",htmlType:"button",disabled:j||S,onClick:()=>r(),"data-sentry-element":"Button","data-sentry-source-file":"CreateBucketModal.tsx",children:"Cancel"}),(0,s.jsx)(J.$,{type:"primary",htmlType:"submit",loading:j||S,disabled:j||S,"data-sentry-element":"Button","data-sentry-source-file":"CreateBucketModal.tsx",children:"Create"})]})]})})})};var X=a(27642),ee=a(95708);async function et(e){let{projectRef:t,id:a,isPublic:s,file_size_limit:n,allowed_mime_types:l}=e;if(!t)throw Error("projectRef is required");if(!a)throw Error("Bucket name is requried");let r={public:s};void 0!==n&&(r.file_size_limit=n),void 0!==l&&(r.allowed_mime_types=l);let{data:i,error:o}=await (0,C.F6)("/platform/storage/{ref}/buckets/{id}",{params:{path:{id:a,ref:t}},body:r});return o&&(0,C.H4)(o),i}let ea=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,A.jE)();return(0,S.n)(e=>et(e),{async onSuccess(t,a,n){let{projectRef:l}=a;await s.invalidateQueries(z.w.buckets(l)),await (null==e?void 0:e(t,a,n))},async onError(e,a,s){void 0===t?v.oR.error("Failed to update bucket: ".concat(e.message)):t(e,a,s)},...a})},es=e=>{var t;let{visible:a,bucket:n,onClose:l}=e,{ref:r}=(0,h.g)(),{mutate:i,isLoading:o}=ea({onSuccess:()=>{v.oR.success('Successfully updated bucket "'.concat(null==n?void 0:n.name,'"')),l()}}),{data:c}=(0,N.I)({projectRef:r},{enabled:B.pe&&a}),{value:d,unit:m}=(0,$.Jb)(null!=(t=null==c?void 0:c.fileSizeLimit)?t:0),x="".concat(d," ").concat(m),[f,b]=(0,p.useState)(k.s2.BYTES),[y,j]=(0,p.useState)(!1),w=async e=>void 0===n?console.error("Bucket is required"):void 0===r?console.error("Project ref is required"):void i({projectRef:r,id:n.id,isPublic:e.public,file_size_limit:e.has_file_size_limit?(0,$.OG)(e.formatted_size_limit,f):null,allowed_mime_types:e.allowed_mime_types.length>0?e.allowed_mime_types.split(",").map(e=>e.trim()):null});return(0,p.useEffect)(()=>{if(a){var e;let{unit:t}=(0,$.Jb)(null!=(e=null==n?void 0:n.file_size_limit)?e:0);b(t),j(!1)}},[a]),(0,s.jsx)(P.A,{hideFooter:!0,visible:a,size:"medium",header:'Edit bucket "'.concat(null==n?void 0:n.name,'"'),onCancel:l,"data-sentry-element":"Modal","data-sentry-component":"EditBucketModal","data-sentry-source-file":"EditBucketModal.tsx",children:(0,s.jsx)(X.A,{validateOnBlur:!1,initialValues:{},validate:e=>{let t={};return e.has_file_size_limit&&e.formatted_size_limit<0&&(t.formatted_size_limit="File size upload limit has to be at least 0"),t},onSubmit:w,"data-sentry-element":"Form","data-sentry-source-file":"EditBucketModal.tsx",children:e=>{let{values:t,resetForm:i}=e,c=(null==n?void 0:n.public)!==t.public,d=(null==n?void 0:n.public)&&!t.public,m=!(null==n?void 0:n.public)&&t.public;return(0,p.useEffect)(()=>{if(a&&void 0!==n){var e,t,s;let{value:a}=(0,$.Jb)(null!=(e=n.file_size_limit)?e:0),l={name:null!=(t=n.name)?t:"",public:n.public,file_size_limit:n.file_size_limit,allowed_mime_types:(null!=(s=n.allowed_mime_types)?s:[]).join(", "),has_file_size_limit:null!==n.file_size_limit,formatted_size_limit:null!=a?a:0};i({values:l,initialValues:l})}},[a]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(P.A.Content,{className:(0,W.cn)("!px-0",c&&"!pb-0"),children:[(0,s.jsx)(ee.A,{disabled:!0,id:"name",name:"name",type:"text",className:"w-full px-5",layout:"vertical",label:"Name of bucket",labelOptional:"Buckets cannot be renamed once created."}),(0,s.jsxs)("div",{className:(0,W.cn)("flex flex-col gap-y-2 mt-6"),children:[(0,s.jsx)(G.A,{id:"public",name:"public",layout:"flex",label:"Public bucket",className:"px-5",descriptionText:"Anyone can read any object without any authorization"}),c&&(0,s.jsxs)(V.Z,{type:"warning",className:"rounded-none border-x-0 border-b-0 mb-0 [&>div>p]:!leading-normal",title:m?"Warning: Making bucket public":d?"Warning: Making bucket private":"",children:[(0,s.jsx)("p",{children:m?"This will make all objects in your bucket publicly accessible.":d?"All objects in your bucket will be private and only accessible via signed URLs, or downloaded with the right authorisation headers.":""}),d&&(0,s.jsxs)("p",{children:["Assets cached in the CDN may still be publicly accessible. You can consider"," ",(0,s.jsx)(_.g,{href:"https://supabase.com/docs/guides/storage/cdn/smart-cdn#cache-eviction",children:"purging the cache"})," ","or moving your assets to a new bucket."]})]})]})]}),(0,s.jsxs)(F.Ay,{open:y,onOpenChange:()=>j(!y),children:[(0,s.jsx)(F.Ay.Trigger,{asChild:!0,children:(0,s.jsxs)("div",{className:"w-full cursor-pointer py-3 px-5 flex items-center justify-between border-t border-default",children:[(0,s.jsx)("p",{className:"text-sm",children:"Additional configuration"}),(0,s.jsx)(g.A,{size:18,strokeWidth:2,className:(0,W.cn)("text-foreground-light",y&&"rotate-180")})]})}),(0,s.jsx)(F.Ay.Content,{className:"py-4",children:(0,s.jsxs)("div",{className:"w-full space-y-4 px-5",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(G.A,{id:"has_file_size_limit",name:"has_file_size_limit",layout:"flex",label:"Restrict file upload size for bucket",descriptionText:"Prevent uploading of file sizes greater than a specified limit"}),t.has_file_size_limit&&(0,s.jsxs)("div",{className:"grid grid-cols-12 col-span-12 gap-x-2 gap-y-1",children:[(0,s.jsx)("div",{className:"col-span-8",children:(0,s.jsx)(ee.A,{type:"number",step:1,id:"formatted_size_limit",name:"formatted_size_limit",disabled:!1,onKeyPress:e=>{(e.charCode<48||e.charCode>57)&&e.preventDefault()},descriptionText:"Equivalent to ".concat((0,$.OG)(t.formatted_size_limit,f).toLocaleString()," bytes.")})}),(0,s.jsx)("div",{className:"col-span-4",children:(0,s.jsx)(U.A,{id:"size_limit_units",disabled:!1,value:f,onChange:b,children:Object.values(k.s2).map(e=>(0,s.jsx)(U.A.Option,{label:e,value:e,children:(0,s.jsx)("div",{children:e})},e))})}),B.pe&&(0,s.jsx)("div",{className:"col-span-12 mt-2",children:(0,s.jsxs)("p",{className:"text-foreground-light text-sm",children:["Note: Individual bucket upload will still be capped at the"," ",(0,s.jsx)(u(),{href:"/project/".concat(r,"/settings/storage"),className:"font-bold underline",children:"global upload limit"})," ","of ",x]})})]})]}),(0,s.jsx)(ee.A,{id:"allowed_mime_types",name:"allowed_mime_types",layout:"vertical",label:"Allowed MIME types",placeholder:"e.g image/jpeg, image/png, audio/mpeg, video/mp4, etc",labelOptional:"Comma separated values",descriptionText:"Wildcards are allowed, e.g. image/*. Leave blank to allow any MIME type."})]})})]}),(0,s.jsx)(P.A.Separator,{}),(0,s.jsxs)(P.A.Content,{className:"flex items-center space-x-2 justify-end",children:[(0,s.jsx)(J.$,{type:"default",disabled:o,onClick:()=>l(),children:"Cancel"}),(0,s.jsx)(J.$,{type:"primary",htmlType:"submit",loading:o,disabled:o,children:"Save"})]})]})}})})};var en=a(37352);async function el(e){let{projectRef:t,id:a}=e;if(!t)throw Error("projectRef is required");if(!a)throw Error("Bucket name is requried");let{data:s,error:n}=await (0,C.bE)("/platform/storage/{ref}/buckets/{id}/empty",{params:{path:{id:a,ref:t}}});return n&&(0,C.H4)(n),s}let er=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,A.jE)();return(0,S.n)(e=>el(e),{async onSuccess(t,a,n){let{projectRef:l}=a;await s.invalidateQueries(z.w.buckets(l)),await (null==e?void 0:e(t,a,n))},async onError(e,a,s){void 0===t?v.oR.error("Failed to empty bucket: ".concat(e.message)):t(e,a,s)},...a})};var ei=a(34424),eo=a(50204);let ec=e=>{let{visible:t=!1,bucket:a,onClose:n}=e,{ref:l}=(0,h.g)(),{fetchFolderContents:r}=(0,ei.$)(),{mutate:i,isLoading:o}=er({onSuccess:async()=>{void 0!==a&&(await r({bucketId:a.id,folderId:a.id,folderName:a.name,index:-1}),v.oR.success("Successfully deleted bucket ".concat(a.name)),n())}}),c=async()=>l?a?void i({projectRef:l,id:a.id}):console.error("No bucket is selected"):console.error("Project ref is required");return(0,s.jsx)(eo.A,{variant:"destructive",size:"small",title:"Confirm to delete all contents from ".concat(null==a?void 0:a.name),confirmLabel:"Empty bucket",visible:t,loading:o,onCancel:()=>n(),onConfirm:c,alert:{title:"This action cannot be undone",description:"The contents of your bucket cannot be recovered once deleted"},"data-sentry-element":"ConfirmationModal","data-sentry-component":"EmptyBucketModal","data-sentry-source-file":"EmptyBucketModal.tsx",children:(0,s.jsxs)("p",{className:"text-sm",children:['Are you sure you want to empty the bucket "',null==a?void 0:a.name,'"?']})})};var ed=a(88602),eu=a(90437),em=a(86349),ep=a(75019),eh=a(5483),ex=a(43242),ef=a(4601),eb=a(83927),eg=a.n(eb),ey=a(57624),ev=a(89080),ej=a(74680),ew=a(17089),ek=a(2119),e_=a(78721),eN=a(71139);let eA=e=>{let{bucket:t,projectRef:a="",isSelected:n=!1,onSelectEmptyBucket:l=eg(),onSelectDeleteBucket:i=eg(),onSelectEditBucket:o=eg()}=e,c=(0,ep.SE)(r.aG.STORAGE_WRITE,"*");return(0,s.jsxs)("div",{className:(0,W.cn)("group flex items-center justify-between rounded-md",n&&"text-foreground bg-surface-100"),"data-sentry-component":"BucketRow","data-sentry-source-file":"BucketRow.tsx",children:[(0,s.jsx)(u(),{href:"/project/".concat(a,"/storage/buckets/").concat(encodeURIComponent(t.id)),className:"py-1 px-3 grow","data-sentry-element":"Link","data-sentry-source-file":"BucketRow.tsx",children:(0,s.jsxs)("div",{className:"flex items-center justify-between space-x-2 truncate w-full",children:[(0,s.jsx)("p",{className:"text-sm group-hover:text-foreground transition truncate ".concat(n?"text-foreground":"text-foreground-light"),title:t.name,children:t.name}),t.public&&(0,s.jsx)(ek.E,{variant:"warning",children:"Public"}),"ANALYTICS"===t.type&&(0,s.jsxs)(e_.m_,{children:[(0,s.jsx)(e_.k$,{asChild:!0,children:(0,s.jsx)(ey.A,{className:"text-foreground-lighter",size:"20"})}),(0,s.jsx)(e_.ZI,{children:(0,s.jsx)("p",{children:"Analytics bucket"})})]})]})}),c&&n?(0,s.jsxs)(eN.rI,{children:[(0,s.jsx)(eN.ty,{asChild:!0,children:(0,s.jsx)(J.$,{type:"text",icon:(0,s.jsx)(g.A,{}),className:"mr-1 p-1.5 w-7"})}),(0,s.jsxs)(eN.SQ,{side:"bottom",align:"start",children:["ANALYTICS"!==t.type&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(eN._2,{className:"space-x-2",onClick:()=>o(),children:[(0,s.jsx)(ev.A,{size:14}),(0,s.jsx)("p",{children:"Edit bucket"})]},"toggle-private"),(0,s.jsx)(eN.mB,{}),(0,s.jsxs)(eN._2,{className:"space-x-2",onClick:()=>l(),children:[(0,s.jsx)(ej.A,{size:14}),(0,s.jsx)("p",{children:"Empty bucket"})]},"empty-bucket")]}),(0,s.jsxs)(eN._2,{className:"space-x-2",onClick:()=>i(),children:[(0,s.jsx)(ew.A,{size:14}),(0,s.jsx)("p",{children:"Delete bucket"})]},"delete-bucket")]})]}):(0,s.jsx)("div",{className:"w-7 mr-1"})]},t.id)},eS=()=>{let e=(0,m.useRouter)(),{ref:t,bucketId:a}=(0,h.g)(),n=(0,eh.KT)(),l=(null==n?void 0:n.parent_project_ref)!==void 0,[d,x]=(0,p.useState)(""),[f,b]=(0,p.useState)(!1),[g,y]=(0,p.useState)(),[v,j]=(0,p.useState)(),[w,k]=(0,p.useState)(),_=(0,ep.SE)(r.aG.STORAGE_WRITE,"*"),[N,A]=(0,i.Mj)("storage-explorer-sort","created-at"),S=e.pathname.split("/")[4],{data:C=[],error:z,isLoading:E,isError:T,isSuccess:M}=(0,em.p)({projectRef:t}),R="alphabetical"===N?C.sort((e,t)=>e.name.toLowerCase().trim().localeCompare(t.name.toLowerCase().trim())):C.sort((e,t)=>new Date(t.created_at)>new Date(e.created_at)?-1:1),I=d.length>1?R.filter(e=>e.name.includes(d.trim())):R,B=(null==z?void 0:z.message.includes("Tenant config"))&&l;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(ex.Ay,{type:"pills",className:"my-6 flex flex-grow flex-col","data-sentry-element":"Menu","data-sentry-source-file":"StorageMenu.tsx",children:[(0,s.jsxs)("div",{className:"mb-6 mx-5 flex flex-col gap-y-1.5",children:[(0,s.jsx)(ed.G,{block:!0,type:"default",icon:(0,s.jsx)(o.A,{}),disabled:!_,style:{justifyContent:"start"},onClick:()=>b(!0),tooltip:{content:{side:"bottom",text:_?void 0:"You need additional permissions to create buckets"}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"StorageMenu.tsx",children:"New bucket"}),(0,s.jsx)(ef.a0,{className:"px-0","data-sentry-element":"InnerSideBarFilters","data-sentry-source-file":"StorageMenu.tsx",children:(0,s.jsx)(ef.RK,{name:"search-buckets","aria-labelledby":"Search buckets",placeholder:"Search buckets...",value:d,onChange:e=>{x(e.target.value)},"data-sentry-element":"InnerSideBarFilterSearchInput","data-sentry-source-file":"StorageMenu.tsx",children:(0,s.jsxs)(ef.i9,{value:N,onValueChange:e=>A(e),"data-sentry-element":"InnerSideBarFilterSortDropdown","data-sentry-source-file":"StorageMenu.tsx",children:[(0,s.jsx)(ef.Pl,{value:"alphabetical",className:"flex gap-2","data-sentry-element":"InnerSideBarFilterSortDropdownItem","data-sentry-source-file":"StorageMenu.tsx",children:"Alphabetical"},"alphabetical"),(0,s.jsx)(ef.Pl,{value:"created-at","data-sentry-element":"InnerSideBarFilterSortDropdownItem","data-sentry-source-file":"StorageMenu.tsx",children:"Created at"},"created-at")]})})})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"mx-3",children:[(0,s.jsx)(ex.Ay.Group,{title:(0,s.jsx)("span",{className:"uppercase font-mono",children:"All buckets"}),"data-sentry-element":"unknown","data-sentry-source-file":"StorageMenu.tsx"}),E&&(0,s.jsxs)("div",{className:"space-y-2 mx-2",children:[(0,s.jsx)(eu.A,{className:"!py-2.5"}),(0,s.jsx)(eu.A,{className:"!py-2.5"}),(0,s.jsx)(eu.A,{className:"!py-2.5"})]}),T&&(0,s.jsx)("div",{className:"px-2",children:(0,s.jsxs)(Y.Fc,{variant:B?"default":"warning",children:[(0,s.jsx)(Y.XL,{className:"text-xs tracking-normal",children:B?"Storage is not available on preview branches for now":"Failed to fetch buckets"}),(0,s.jsx)(Y.TN,{className:"text-xs",children:B?"We're actively looking into making this available on preview branches":"Please refresh to try again"})]})}),M&&(0,s.jsxs)(s.Fragment,{children:[0===C.length&&(0,s.jsx)(ef.Q5,{className:"mx-2",title:"No buckets available",description:"Buckets that you create will appear here"}),d.length>0&&0===I.length&&(0,s.jsx)(ef.Q5,{className:"mx-2",title:"No results found",description:'Your search for "'.concat(d,'" did not return any results')}),I.map((e,n)=>{let l=a===e.id;return(0,s.jsx)(eA,{bucket:e,projectRef:t,isSelected:l,onSelectEmptyBucket:()=>j(e),onSelectDeleteBucket:()=>k(e),onSelectEditBucket:()=>y(e)},"".concat(n,"_").concat(e.id))})]})]}),(0,s.jsx)("div",{className:"h-px w-full bg-border"}),(0,s.jsxs)("div",{className:"mx-3",children:[(0,s.jsx)(ex.Ay.Group,{title:(0,s.jsx)("span",{className:"uppercase font-mono",children:"Configuration"}),"data-sentry-element":"unknown","data-sentry-source-file":"StorageMenu.tsx"}),(0,s.jsx)(u(),{href:"/project/".concat(t,"/storage/policies"),"data-sentry-element":"Link","data-sentry-source-file":"StorageMenu.tsx",children:(0,s.jsx)(ex.Ay.Item,{rounded:!0,active:"policies"===S,"data-sentry-element":"unknown","data-sentry-source-file":"StorageMenu.tsx",children:(0,s.jsx)("p",{className:"truncate",children:"Policies"})})}),(0,s.jsx)(u(),{href:"/project/".concat(t,"/settings/storage"),"data-sentry-element":"Link","data-sentry-source-file":"StorageMenu.tsx",children:(0,s.jsx)(ex.Ay.Item,{rounded:!0,"data-sentry-element":"unknown","data-sentry-source-file":"StorageMenu.tsx",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("p",{className:"truncate",children:"Settings"}),(0,s.jsx)(c.A,{strokeWidth:1,className:"h-4 w-4","data-sentry-element":"ArrowUpRight","data-sentry-source-file":"StorageMenu.tsx"})]})})})]})]})]}),(0,s.jsx)(Z,{visible:f,onClose:()=>b(!1),"data-sentry-element":"CreateBucketModal","data-sentry-source-file":"StorageMenu.tsx"}),(0,s.jsx)(es,{visible:void 0!==g,bucket:g,onClose:()=>y(void 0),"data-sentry-element":"EditBucketModal","data-sentry-source-file":"StorageMenu.tsx"}),(0,s.jsx)(ec,{visible:void 0!==v,bucket:v,onClose:()=>j(void 0),"data-sentry-element":"EmptyBucketModal","data-sentry-source-file":"StorageMenu.tsx"}),(0,s.jsx)(en.vd,{visible:void 0!==w,bucket:w,onClose:()=>k(void 0),"data-sentry-element":"DeleteBucketModal","data-sentry-source-file":"StorageMenu.tsx"})]})},eC=(0,n.r)(e=>{let{title:t,children:a}=e;return(0,s.jsx)(l.A,{title:t||"Storage",product:"Storage",productMenu:(0,s.jsx)(eS,{}),"data-sentry-element":"ProjectLayout","data-sentry-component":"StorageLayout","data-sentry-source-file":"StorageLayout.tsx",children:a})})},91435:(e,t,a)=>{a.d(t,{z:()=>d});var s=a(56947),n=a(65172),l=a(28140),r=a(5483),i=a(63492),o=a(89811);async function c(e,t,a){let{projectRef:s,connectionString:l}=e;if(!s)throw Error("projectRef is required");let r=new Headers(a);l&&r.set("x-connection-encrypted",l);let{data:i,error:c}=await (0,n.Jt)("/platform/pg-meta/{ref}/extensions",{params:{header:{"x-connection-encrypted":l,"x-pg-application-name":o.r},path:{ref:s}},headers:r,signal:t});return c&&(0,n.H4)(c),i}let d=function(e){let{projectRef:t,connectionString:a}=e,{enabled:n=!0,...o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},d=(0,r.KT)(),u=(null==d?void 0:d.status)===i.BU.ACTIVE_HEALTHY;return(0,s.I)(l.I.list(t),e=>{let{signal:s}=e;return c({projectRef:t,connectionString:a},s)},{enabled:n&&void 0!==t&&u,...o})}}}]);