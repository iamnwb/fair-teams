!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="163f1386-f9b8-4bc6-a8cd-24943bc0412b",e._sentryDebugIdIdentifier="sentry-dbid-163f1386-f9b8-4bc6-a8cd-24943bc0412b")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4986,9919],{4870:(e,t,s)=>{"use strict";s.d(t,{s:()=>c,v:()=>d});var a=s(80263),n=s(72342),r=s(53239),l=s(25757),o=s(19428),i=s(51500);let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.bL,{className:(0,i.cn)("flex flex-col -space-y-px w-full",s),...r,ref:t})});c.displayName="RadioGroupStacked";let d=r.forwardRef((e,t)=>{let{image:s,label:r,showIndicator:c=!0,...d}=e;return(0,a.jsx)(n.q7,{ref:t,...d,className:(0,i.cn)("flex flex-col gap-2","w-full","bg-overlay/50 disabled:opacity-50","border","first-of-type:rounded-t-lg last-of-type:rounded-b-lg","shadow-sm","enabled:hover:bg-surface-300","enabled:hover:border-foreground-muted","enabled:cursor-pointer disabled:cursor-not-allowed","hover:z-[1] focus-visible:z-[1]","data-[state=checked]:z-[1]","data-[state=checked]:ring-1 data-[state=checked]:ring-border","data-[state=checked]:bg-surface-300","data-[state=checked]:border-foreground-muted","transition","group",d.className),children:(0,a.jsxs)("div",{className:"flex gap-3 w-full px-[21px] py-3",children:[c&&(0,a.jsx)("div",{className:(0,i.cn)("aspect-square h-4 w-4 min-w-4 min-h-4","rounded-full border group-data-[state=checked]:border-foreground-muted","group-focus:border-foreground-muted","group-hover:border-foreground-muted","ring-offset-background","group-focus:outline-none","group-focus-visible:ring-2 group-focus-visible:ring-ring group-focus-visible:ring-offset-2","flex items-center justify-center","transition"),children:(0,a.jsx)(n.C1,{className:"flex items-center justify-center",children:(0,a.jsx)(l.A,{className:"h-2.5 w-2.5 fill-current text-current"})})}),(0,a.jsxs)("div",{className:"flex flex-col gap-0.25 items-start",children:[(0,a.jsx)(o.J,{htmlFor:d.value,className:(0,i.cn)("block","-mt-[0.15rem]","text-sm transition-colors text-left","text-light","enabled:group-hover:text-foreground group-data-[state=checked]:text-foreground"),children:r}),d.description&&(0,a.jsx)("p",{className:"text-sm text-foreground-lighter",children:d.description}),d.children]})]})})});d.displayName="RadioGroupStackedItem"},5816:(e,t,s)=>{"use strict";s.d(t,{$E:()=>u,kV:()=>c,op:()=>d});var a=s(56947),n=s(32144),r=s(65172),l=s(63492),o=s(53239),i=s(58982);async function c(e,t){let{projectRef:s}=e;if(!s)throw Error("projectRef is required");let{data:a,error:n}=await (0,r.Jt)("/platform/auth/{ref}/config",{params:{path:{ref:s}},signal:t});return n&&(0,r.H4)(n),a}let d=function(e){let{projectRef:t}=e,{enabled:s=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.I)(i.Z.authConfig(t),e=>{let{signal:s}=e;return c({projectRef:t},s)},{enabled:s&&l.pe&&void 0!==t,...n})},u=e=>{let{projectRef:t}=e,s=(0,n.jE)();return(0,o.useCallback)(()=>{t&&s.prefetchQuery(i.Z.authConfig(t),e=>{let{signal:s}=e;return c({projectRef:t},s)})},[s,t])}},12101:(e,t,s)=>{"use strict";s.d(t,{M:()=>S});var a=s(80263),n=s(15601),r=s.n(n),l=s(24400),o=s(90478),i=s(51500),c=s(39358),d=s(2119),u=s(40022),h=s(92882),m=s(99846),f=s(53239),x=s(38694),p=s(95043);let g=f.forwardRef((e,t)=>{let{...s}=e;return(0,a.jsx)("nav",{ref:t,"aria-label":"breadcrumb",...s})});g.displayName="Breadcrumb";let y=f.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("ol",{ref:t,className:(0,i.cn)("flex flex-wrap items-center gap-0.5 break-words text-sm text-muted-foreground sm:gap-1.5",s),...n})});y.displayName="BreadcrumbList";let j=f.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("li",{ref:t,className:(0,i.cn)("inline-flex text-foreground-lighter items-center gap-1.5 leading-5",s),...n})});j.displayName="BreadcrumbItem";let b=f.forwardRef((e,t)=>{let{asChild:s,className:n,...r}=e,l=s?x.DX:"a";return(0,a.jsx)(l,{ref:t,className:(0,i.cn)("transition-colors underline lg:no-underline hover:text-foreground",n),...r})});b.displayName="BreadcrumbLink";let v=f.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("span",{ref:t,role:"link","aria-disabled":"true","aria-current":"page",className:(0,i.cn)("no-underline text-foreground",s),...n})});v.displayName="BreadcrumbPage";let N=e=>{let{children:t,className:s,...n}=e;return(0,a.jsx)("li",{role:"presentation","aria-hidden":"true",className:(0,i.cn)("[&>svg]:size-3.5",s),...n,"data-sentry-component":"BreadcrumbSeparator","data-sentry-source-file":"breadcrumb.tsx",children:null!=t?t:(0,a.jsx)(p.A,{})})};N.displayName="BreadcrumbSeparator";let w=e=>{let{title:t,subtitle:s,icon:n,breadcrumbs:l=[],primaryActions:c,secondaryActions:d,className:u,isCompact:x=!1}=e,{ref:p}=(0,o.g)(),w=x&&t?[...l,{label:t}]:l;return(0,a.jsxs)("div",{className:(0,i.cn)("space-y-4",u),"data-sentry-component":"PageHeader","data-sentry-source-file":"PageHeader.tsx",children:[(w.length>0||x&&(t||c||d))&&(0,a.jsxs)("div",{className:(0,i.cn)("flex items-center gap-4",x?"justify-between":"mb-4"),children:[(0,a.jsx)("div",{className:"flex items-center gap-4",children:l.length>0?(0,a.jsx)(g,{className:(0,i.cn)("text-foreground-muted",x&&"text-base"),children:(0,a.jsxs)(y,{className:x?"text-base":"text-xs",children:[l.map((e,t)=>(0,a.jsxs)(f.Fragment,{children:[(0,a.jsx)(j,{children:e.element?e.element:e.href?(0,a.jsx)(b,{asChild:!0,className:"flex items-center gap-2",children:(0,a.jsxs)(r(),{href:p?e.href.replace("[ref]",p):e.href,children:[1===l.length&&!x&&(0,a.jsx)(m.A,{size:16,strokeWidth:1.5}),e.label]})}):(0,a.jsxs)(v,{className:"flex items-center gap-2",children:[1===l.length&&(0,a.jsx)(m.A,{size:16,strokeWidth:1.5}),e.label]})}),t<l.length-1&&(0,a.jsx)(N,{})]},e.label||"breadcrumb-".concat(t))),x&&t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(N,{}),(0,a.jsx)(j,{children:(0,a.jsx)(v,{children:t})})]})]})}):x?t:null}),x&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[d&&(0,a.jsx)("div",{className:"flex items-center gap-2",children:d}),c&&(0,a.jsx)("div",{className:"flex items-center gap-2",children:c})]})]}),!x&&(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[n&&(0,a.jsx)("div",{className:"text-foreground-light",children:n}),(0,a.jsxs)("div",{className:"space-y-1",children:[t&&(0,a.jsx)(h.Dm,{children:t}),s&&(0,a.jsx)(h.dX,{className:"text-sm text-foreground-light",children:s})]})]})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[d&&(0,a.jsx)("div",{className:"flex items-center gap-2",children:d}),c&&(0,a.jsx)("div",{className:"flex items-center gap-2",children:c})]})]})]})},S=e=>{let{children:t,title:s,subtitle:n,icon:m,breadcrumbs:f=[],primaryActions:x,secondaryActions:p,navigationItems:g=[],className:y,size:j="default",isCompact:b=!1}=e,{ref:v}=(0,o.g)(),N=(0,l.useRouter)();return(0,a.jsxs)("div",{className:"w-full min-h-full flex flex-col items-stretch","data-sentry-component":"PageLayout","data-sentry-source-file":"PageLayout.tsx",children:[(0,a.jsxs)(h.eh,{size:j,className:(0,i.cn)("w-full mx-auto","full"===j&&(b?"max-w-none !px-6 border-b pt-4":"max-w-none pt-6 border-b"),"full"!==j&&(b?"pt-4":"pt-12"),0===g.length&&"full"===j&&(b?"pb-4":"pb-8"),y),"data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"PageLayout.tsx",children:[(s||n||x||p||f.length>0)&&(0,a.jsx)(w,{title:s,subtitle:n,icon:m,breadcrumbs:f,primaryActions:x,secondaryActions:p,isCompact:b}),g.length>0&&(0,a.jsx)(c.h,{className:(0,i.cn)(b?"mt-2":"mt-4","full"===j&&"border-none"),children:g.map(e=>{let t=void 0!==e.active?e.active:N.asPath.split("?")[0]===e.href;return(0,a.jsx)(c.O,{active:t,children:e.href?(0,a.jsxs)(r(),{href:e.href.includes("[ref]")&&v?e.href.replace("[ref]",v):e.href,className:(0,i.cn)("inline-flex items-center gap-2",t&&"text-foreground"),onClick:e.onClick,children:[e.icon&&(0,a.jsx)("span",{children:e.icon}),e.label,e.badge&&(0,a.jsx)(d.E,{variant:"default",children:e.badge})]}):(0,a.jsxs)(u.$,{type:"link",onClick:e.onClick,className:(0,i.cn)(t&&"text-foreground font-medium"),children:[e.icon&&(0,a.jsx)("span",{className:"mr-2",children:e.icon}),e.label,e.badge&&(0,a.jsx)(d.E,{variant:"default",children:e.badge})]})},e.label)})})]}),t]})}},23886:(e,t,s)=>{"use strict";s.d(t,{GQ:()=>r,Il:()=>l});var a=s(97344),n=s.n(a);function r(e){let t=null==e?void 0:e.split(",").map(e=>e.trim());return n()(e)||!t||0===t.length?{value:[]}:{value:t.map(e=>{let t=e.match(/(\w+)\s+([\w\[\]]+)(?:\s+DEFAULT\s+(.*))?/i);if(!t)return console.error("Error while trying to parse function arguments",e),null;{let[,e,s,a]=t,n=a?a.trim():void 0;return["timestamp","time","timetz","timestamptz"].includes(s.toLowerCase())&&n&&(n="'".concat(n,"'")),{name:e,type:s,defaultValue:n}}}).filter(Boolean)}}function l(e){let t=[];if(e)for(var s in e)t.push({name:s,value:e[s]});return{value:t}}},24771:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var a=s(80263);s(53239);let n=function(e){let{children:t,target:s="_blank",href:n,className:r,onClick:l,style:o}=e;return(0,a.jsx)("a",{onClick:l,href:n,target:s,rel:"noopener noreferrer",style:o,"data-sentry-component":"Link","data-sentry-source-file":"Link.tsx",children:t})}},27939:(e,t,s)=>{"use strict";s.d(t,{A:()=>g});var a=s(80263),n=s(15601),r=s.n(n),l=s(24400),o=s(90478),i=s(72035),c=s(90226),d=s(5816),u=s(52361),h=s(1012),m=s(40022),f=s(78098),x=s(32267);let p=()=>{let e=(0,l.useRouter)(),{ref:t="default"}=(0,o.g)(),s=(0,i.p4)();(0,d.$E)({projectRef:t});let n=e.pathname.split("/")[4];return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.l,{page:n,menu:(0,x.B)(t),"data-sentry-element":"ProductMenu","data-sentry-source-file":"AuthLayout.tsx"}),s&&(0,a.jsx)("div",{className:"px-3",children:(0,a.jsxs)(h.Fc,{children:[(0,a.jsx)(h.XL,{className:"text-sm",children:"Column Privileges has been shifted"}),(0,a.jsxs)(h.TN,{className:"text-xs",children:[(0,a.jsx)("p",{className:"mb-2",children:"It can now be found in the menu under the database section."}),(0,a.jsx)(m.$,{asChild:!0,type:"default",size:"tiny",children:(0,a.jsx)(r(),{href:"/project/".concat(t,"/database/column-privileges"),children:"Head over to Database"})})]})]})})]})},g=(0,u.r)(e=>{let{children:t}=e;return(0,a.jsx)(f.A,{title:"Authentication",product:"Authentication",productMenu:(0,a.jsx)(p,{}),isBlocking:!1,"data-sentry-element":"ProjectLayout","data-sentry-component":"AuthLayout","data-sentry-source-file":"AuthLayout.tsx",children:t})})},36729:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>eu});var a=s(80263),n=s(60045),r=s(53239),l=s(73969),o=s(90478),i=s(98832),c=s(92882),d=s(20313),u=s(82143),h=s(5816),m=s(32144),f=s(80251),x=s(65172),p=s(58982);async function g(e){let{projectRef:t,config:s}=e,{data:a,error:n}=await (0,x.F6)("/platform/auth/{ref}/config/hooks",{params:{path:{ref:t}},body:s});return n&&(0,x.H4)(n),a}let y=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,m.jE)();return(0,f.n)(e=>g(e),{async onSuccess(t,s,n){let{projectRef:r}=s;await a.invalidateQueries(p.Z.authConfig(r)),await (null==e?void 0:e(t,s,n))},async onError(e,s,a){void 0===t?l.oR.error("Failed to update auth hooks: ".concat(e.message)):t(e,s,a)},...s})};var j=s(15629),b=s(51500),v=s(50204),N=s(72259),w=s(88602),S=s(75019),k=s(23385),A=s(71139),C=s(40022);let _=[{title:"Send SMS hook",subtitle:"Will be called by Supabase Auth each time an SMS message needs to be sent.",enabledKey:"HOOK_SEND_SMS_ENABLED",uriKey:"HOOK_SEND_SMS_URI",secretsKey:"HOOK_SEND_SMS_SECRETS",enterprise:!1,docSlug:"send-sms-hook"},{title:"Send Email hook",subtitle:"Will be called by Supabase Auth each time an email message needs to be sent.",enabledKey:"HOOK_SEND_EMAIL_ENABLED",uriKey:"HOOK_SEND_EMAIL_URI",secretsKey:"HOOK_SEND_EMAIL_SECRETS",enterprise:!1,docSlug:"send-email-hook"},{title:"Customize Access Token (JWT) Claims hook",subtitle:"Will be called by Supabase Auth each time a new JWT is created. It should return the claims you wish to be present in the JWT.",enabledKey:"HOOK_CUSTOM_ACCESS_TOKEN_ENABLED",uriKey:"HOOK_CUSTOM_ACCESS_TOKEN_URI",secretsKey:"HOOK_CUSTOM_ACCESS_TOKEN_SECRETS",enterprise:!1,docSlug:"custom-access-token-hook"},{title:"MFA Verification Attempt hook",subtitle:"Will be called by Supabase Auth each time a user tries to verify an MFA factor. Return a decision on whether to reject the attempt and future ones, or to allow the user to keep trying.",enabledKey:"HOOK_MFA_VERIFICATION_ATTEMPT_ENABLED",uriKey:"HOOK_MFA_VERIFICATION_ATTEMPT_URI",secretsKey:"HOOK_MFA_VERIFICATION_ATTEMPT_SECRETS",enterprise:!0,docSlug:"mfa-verification-hook"},{title:"Password Verification Attempt hook",subtitle:"Will be called by Supabase Auth each time a user tries to sign in with a password. Return a decision whether to allow the user to reject the attempt, or to allow the user to keep trying.",enabledKey:"HOOK_PASSWORD_VERIFICATION_ATTEMPT_ENABLED",uriKey:"HOOK_PASSWORD_VERIFICATION_ATTEMPT_URI",secretsKey:"HOOK_PASSWORD_VERIFICATION_ATTEMPT_SECRETS",enterprise:!0,docSlug:"password-verification-hook"},{title:"Before User Created hook",subtitle:"Will be called by Supabase Auth before creating a new user. Returning an error will prevent the user from being created.",enabledKey:"HOOK_BEFORE_USER_CREATED_ENABLED",uriKey:"HOOK_BEFORE_USER_CREATED_URI",secretsKey:"HOOK_BEFORE_USER_CREATED_SECRETS",enterprise:!1,docSlug:"before-user-created-hook"}];var E=s(86889);let T=e=>{var t;let{buttonText:s="Add hook",align:r="end",onSelectHook:l}=e,{ref:i}=(0,o.g)(),c=(0,k.a)(),{data:d}=(0,h.op)({projectRef:i}),u=(0,S.SE)(n.aG.AUTH_EXECUTE,"*"),m=_.map(e=>({...e,enabled:(null==d?void 0:d[e.enabledKey])||!1,method:(0,E.vw)((null==d?void 0:d[e.uriKey])||"",(null==d?void 0:d[e.secretsKey])||"")})),f=m.filter(e=>!(0,E.U2)(e)&&!e.enterprise),x=m.filter(e=>!(0,E.U2)(e)&&e.enterprise),p=(null==c?void 0:c.plan.id)==="team"||(null==c?void 0:c.plan.id)==="enterprise";return u?(0,a.jsxs)(A.rI,{"data-sentry-element":"DropdownMenu","data-sentry-component":"AddHookDropdown","data-sentry-source-file":"AddHookDropdown.tsx",children:[(0,a.jsx)(A.ty,{asChild:!0,"data-sentry-element":"DropdownMenuTrigger","data-sentry-source-file":"AddHookDropdown.tsx",children:(0,a.jsx)(C.$,{type:"primary",iconRight:(0,a.jsx)(N.A,{className:"w-4 h-4",strokeWidth:1}),"data-sentry-element":"Button","data-sentry-source-file":"AddHookDropdown.tsx",children:s})}),(0,a.jsxs)(A.SQ,{className:"w-76",align:r,"data-sentry-element":"DropdownMenuContent","data-sentry-source-file":"AddHookDropdown.tsx",children:[(0,a.jsx)("div",{children:f.map(e=>(0,a.jsx)(A._2,{onClick:()=>l(e.title),children:e.title},e.title))}),(0,a.jsx)(A.mB,{"data-sentry-element":"DropdownMenuSeparator","data-sentry-source-file":"AddHookDropdown.tsx"}),!p&&(0,a.jsxs)(A.lp,{className:"grid gap-1 bg-surface-200",children:[(0,a.jsx)("p",{className:"text-foreground-light",children:"Team or Enterprise Plan required"}),(0,a.jsxs)("p",{className:"text-foreground-lighter text-xs",children:["The following hooks are not available on"," ",(0,a.jsx)("a",{target:"_href",href:"https://supabase.com/dashboard/org/".concat(null!=(t=null==c?void 0:c.slug)?t:"_","/billing"),className:"underline",children:"your plan"}),"."]})]}),x.map(e=>p?(0,a.jsx)(A._2,{disabled:!p,className:"",onClick:()=>l(e.title),children:e.title},e.title):(0,a.jsx)(A._2,{disabled:!p,onClick:()=>l(e.title),children:e.title},e.title))]})]}):(0,a.jsx)(w.G,{disabled:!0,type:"primary",tooltip:{content:{side:"bottom",text:"You need additional permissions to add auth hooks"}},children:s})};var R=s(32981),O=s(25643),H=s(39551),M=s.n(H),K=s(87494),I=s(86953),L=s(39353),V=s(23886),D=s(89846),P=s(79015),F=s(9919),z=s(77635),B=s(47452),U=s(13874),W=s(4870),$=s(93210),q=s(61395),G=s(62136);let J="create-edit-auth-hook",X=L.Ik({hookType:L.Yj(),enabled:L.zM(),selectedType:L.KC([L.eu("https"),L.eu("postgres")]),httpsValues:L.Ik({url:L.Yj(),secret:L.Yj()}),postgresValues:L.Ik({schema:L.Yj(),functionName:L.Yj()})}).superRefine((e,t)=>("https"===e.selectedType&&(e.httpsValues.url.startsWith("https://")||t.addIssue({path:["httpsValues","url"],code:L.eq.custom,message:"The URL must start with https://"}),e.httpsValues.secret||t.addIssue({path:["httpsValues","secret"],code:L.eq.custom,message:"Missing secret value"})),"postgres"===e.selectedType&&(e.postgresValues.schema||t.addIssue({path:["postgresValues","schema"],code:L.eq.custom,message:"You must select a schema"}),e.postgresValues.functionName||t.addIssue({path:["postgresValues","functionName"],code:L.eq.custom,message:"You must select a Postgres function"})),!0)),Y=e=>{let{visible:t,title:s,authConfig:n,onClose:c,onDelete:d}=e,{ref:h}=(0,o.g)(),{project:m}=(0,i.Om)(),f=(0,r.useMemo)(()=>_.find(e=>e.title===s)||_[0],[s]),x="HOOK_SEND_EMAIL_ENABLED"===f.enabledKey?["json","jsonb","void"]:["json","jsonb"],p=(0,r.useMemo)(()=>({...f,enabled:(null==n?void 0:n[f.enabledKey])||!1,method:(0,E.vw)((null==n?void 0:n[f.uriKey])||"",(null==n?void 0:n[f.secretsKey])||"")}),[f,n]),g=!(0,E.U2)(p),v=(0,K.mN)({resolver:(0,R.u)(X),defaultValues:{hookType:s||"",enabled:!0,selectedType:"postgres",httpsValues:{url:"",secret:""},postgresValues:{schema:"public",functionName:""}}}),N=v.watch(),w=(0,r.useMemo)(()=>{let e=[];return"postgres"===p.method.type&&""!==p.method.schema&&""!==p.method.functionName&&p.method.functionName!==N.postgresValues.functionName&&(e=(0,E.IT)(p.method.schema,p.method.functionName)),""!==N.postgresValues.functionName&&(e=[...e,"-- Grant access to function to supabase_auth_admin\ngrant execute on function ".concat(N.postgresValues.schema,".").concat(N.postgresValues.functionName," to supabase_auth_admin;"),"-- Grant access to schema to supabase_auth_admin\ngrant usage on schema ".concat(N.postgresValues.schema," to supabase_auth_admin;"),"-- Revoke function permissions from authenticated, anon and public\nrevoke execute on function ".concat(N.postgresValues.schema,".").concat(N.postgresValues.functionName," from authenticated, anon, public;")]),e},[p,N.postgresValues.schema,N.postgresValues.functionName]),{mutate:S,isLoading:k}=y({onSuccess:()=>{l.oR.success("Successfully created ".concat(N.hookType,".")),w.length>0&&(0,j.E)({projectRef:h,connectionString:m.connectionString,sql:w.join("\n")}),c()},onError:e=>{l.oR.error("Failed to create hook: ".concat(e.message))}}),A=async e=>{if(!m)return console.error("Project is required");let t=_.find(t=>e.hookType===t.title);if(!t)return;let s=t.enabledKey,a=t.uriKey,n=t.secretsKey,r="";r="postgres"===e.selectedType?"pg-functions://postgres/".concat(e.postgresValues.schema,"/").concat(e.postgresValues.functionName):e.httpsValues.url,S({projectRef:h,config:{[s]:e.enabled,[a]:r,[n]:"https"===e.selectedType?e.httpsValues.secret:null}})};return(0,r.useEffect)(()=>{if(t)if(f){let e=(0,E.vw)((null==n?void 0:n[f.uriKey])||"",(null==n?void 0:n[f.secretsKey])||"");v.reset({hookType:f.title,enabled:(null==n?void 0:n[f.enabledKey])||!0,selectedType:e.type,httpsValues:{url:"https"===e.type&&e.url||"",secret:"https"===e.type&&e.secret||""},postgresValues:{schema:"postgres"===e.type&&e.schema||"public",functionName:"postgres"===e.type&&e.functionName||""}})}else v.reset({hookType:s||"",enabled:!0,selectedType:"postgres",httpsValues:{url:"",secret:""},postgresValues:{schema:"public",functionName:""}})},[n,s,t,f]),(0,a.jsx)(F.cj,{open:t,onOpenChange:()=>c(),"data-sentry-element":"Sheet","data-sentry-component":"CreateHookSheet","data-sentry-source-file":"CreateHookSheet.tsx",children:(0,a.jsxs)(F.h,{size:"lg",showClose:!1,className:"flex flex-col gap-0","data-sentry-element":"SheetContent","data-sentry-source-file":"CreateHookSheet.tsx",children:[(0,a.jsxs)(F.Fm,{className:"py-3 flex flex-row justify-between items-center border-b-0","data-sentry-element":"SheetHeader","data-sentry-source-file":"CreateHookSheet.tsx",children:[(0,a.jsxs)("div",{className:"flex flex-row gap-3 items-center",children:[(0,a.jsxs)(F.kN,{className:(0,b.cn)("text-muted hover:text ring-offset-background transition-opacity hover:opacity-100","focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2","disabled:pointer-events-none data-[state=open]:bg-secondary","transition"),"data-sentry-element":"SheetClose","data-sentry-source-file":"CreateHookSheet.tsx",children:[(0,a.jsx)(O.A,{className:"h-3 w-3","data-sentry-element":"X","data-sentry-source-file":"CreateHookSheet.tsx"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]}),(0,a.jsx)(F.qp,{className:"truncate","data-sentry-element":"SheetTitle","data-sentry-source-file":"CreateHookSheet.tsx",children:g?"Add ".concat(s):"Update ".concat(s)})]}),(0,a.jsx)(G.A,{href:"https://supabase.com/docs/guides/auth/auth-hooks/"+p.docSlug,"data-sentry-element":"DocsButton","data-sentry-source-file":"CreateHookSheet.tsx"})]}),(0,a.jsx)(z.w,{"data-sentry-element":"Separator","data-sentry-source-file":"CreateHookSheet.tsx"}),(0,a.jsx)(F.Xc,{className:"overflow-auto flex-grow px-0","data-sentry-element":"SheetSection","data-sentry-source-file":"CreateHookSheet.tsx",children:(0,a.jsx)(B.lV,{...v,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"CreateHookSheet.tsx",children:(0,a.jsxs)("form",{id:J,className:"space-y-6 w-full py-5 flex-1",onSubmit:v.handleSubmit(A),children:[(0,a.jsx)(B.zB,{name:"enabled",control:v.control,render:e=>{let{field:t}=e;return(0,a.jsx)(q.M,{layout:"flex",className:"px-5",label:"Enable ".concat(N.hookType),description:"Send SMS hook"===N.hookType?"SMS Provider settings will be disabled in favor of SMS hooks":void 0,children:(0,a.jsx)(B.MJ,{children:(0,a.jsx)(U.d,{checked:t.value,onCheckedChange:t.onChange,disabled:t.disabled})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreateHookSheet.tsx"},"enabled"),(0,a.jsx)(z.w,{"data-sentry-element":"Separator","data-sentry-source-file":"CreateHookSheet.tsx"}),(0,a.jsx)(B.zB,{control:v.control,name:"selectedType",render:e=>{let{field:t}=e;return(0,a.jsx)(q.M,{label:"Hook type",className:"px-5",children:(0,a.jsx)(B.MJ,{children:(0,a.jsxs)(W.s,{value:t.value,onValueChange:e=>t.onChange(e),children:[(0,a.jsx)(W.v,{value:"postgres",id:"postgres",label:"Postgres",description:"Used to call a Postgres function."},"postgres"),(0,a.jsx)(W.v,{value:"https",id:"https",label:"HTTPS",description:"Used to call any HTTPS endpoint."},"https")]})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreateHookSheet.tsx"}),"postgres"===N.selectedType?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-8 px-5",children:[(0,a.jsx)(B.zB,{control:v.control,name:"postgresValues.schema",render:e=>{let{field:t}=e;return(0,a.jsx)(q.M,{label:"Postgres Schema",description:"Postgres schema where the function is defined",children:(0,a.jsx)(B.MJ,{children:(0,a.jsx)(P.A,{portal:!1,size:"small",showError:!1,selectedSchemaName:t.value,onSelectSchema:e=>t.onChange(e),disabled:t.disabled})})})}},"postgresValues.schema"),(0,a.jsx)(B.zB,{control:v.control,name:"postgresValues.functionName",render:e=>{let{field:t}=e;return(0,a.jsx)(q.M,{label:"Postgres function",description:"This function will be called by Supabase Auth each time the hook is triggered",children:(0,a.jsx)(B.MJ,{children:(0,a.jsx)(D.A,{size:"small",schema:N.postgresValues.schema,value:t.value,onChange:t.onChange,disabled:t.disabled,filterFunction:e=>{if(x.includes(e.return_type)){let{value:t}=(0,V.GQ)(e.argument_types);return 1===t.length&&("json"===t[0].type||"jsonb"===t[0].type)}return!1},noResultsLabel:(0,a.jsxs)("span",{children:["No function with a single JSON/B argument",(0,a.jsx)("br",{}),"and JSON/B","HOOK_SEND_EMAIL_ENABLED"===f.enabledKey?" or void":""," ","return type found in this schema."]})})})})}},"postgresValues.functionName")]}),(0,a.jsxs)("div",{className:"h-72 w-full gap-3 flex flex-col",children:[(0,a.jsx)("p",{className:"text-sm text-foreground-light px-5",children:"The following statements will be executed on the selected function:"}),(0,a.jsx)(u.A,{id:"postgres-hook-editor",isReadOnly:!0,language:"pgsql",value:w.join("\n\n")})]})]}):(0,a.jsxs)("div",{className:"flex flex-col gap-4 px-5",children:[(0,a.jsx)(B.zB,{control:v.control,name:"httpsValues.url",render:e=>{let{field:t}=e;return(0,a.jsx)(q.M,{label:"URL",description:"Supabase Auth will send a HTTPS POST request to this URL each time the hook is triggered.",children:(0,a.jsx)(B.MJ,{children:(0,a.jsx)($.p,{...t})})})}},"httpsValues.url"),(0,a.jsx)(B.zB,{control:v.control,name:"httpsValues.secret",render:e=>{let{field:t}=e;return(0,a.jsx)(q.M,{label:"Secret",description:(0,a.jsx)(I.$,{children:"It should be a base64 encoded hook secret with a prefix `v1,whsec_`. `v1` denotes the signature version, and `whsec_` signifies a symmetric secret."}),children:(0,a.jsx)(B.MJ,{children:(0,a.jsxs)("div",{className:"flex flex-row",children:[(0,a.jsx)($.p,{...t,className:"rounded-r-none border-r-0"}),(0,a.jsx)(C.$,{type:"default",size:"small",className:"rounded-l-none",onClick:()=>{let e=function(){let e=M()(60).toString("base64");return"v1,whsec_".concat(e)}();v.setValue("httpsValues.secret",e)},children:"Generate secret"})]})})})}},"httpsValues.secret")]})]})})}),(0,a.jsxs)(F.XW,{"data-sentry-element":"SheetFooter","data-sentry-source-file":"CreateHookSheet.tsx",children:[!g&&(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(C.$,{type:"danger",onClick:()=>d(),children:"Delete hook"})}),(0,a.jsx)(C.$,{disabled:k,type:"default",onClick:()=>c(),"data-sentry-element":"Button","data-sentry-source-file":"CreateHookSheet.tsx",children:"Cancel"}),(0,a.jsx)(C.$,{form:J,htmlType:"submit",disabled:k,loading:k,"data-sentry-element":"Button","data-sentry-source-file":"CreateHookSheet.tsx",children:g?"Create hook":"Update hook"})]})]})})};var Q=s(59350),Z=s(80903),ee=s(95708),et=s(52647),es=s(2119);let ea=e=>{let{hook:t,onSelect:s}=e,r=(0,S.SE)(n.aG.AUTH_EXECUTE,"*");return(0,a.jsxs)("div",{className:"bg-surface-100 border-default overflow-hidden border shadow px-5 py-4 flex flex-row first:rounded-t-md last:rounded-b-md space-x-4","data-sentry-component":"HookCard","data-sentry-source-file":"HookCard.tsx",children:[(0,a.jsx)("div",{className:"",children:(0,a.jsx)(Q.A,{size:21,strokeWidth:"1","data-sentry-element":"Webhook","data-sentry-source-file":"HookCard.tsx"})}),(0,a.jsxs)("div",{className:"flex flex-col flex-0 overflow-y-auto w-full",children:[(0,a.jsx)("span",{className:"text-sm text-foreground",children:t.title}),(0,a.jsx)("span",{className:"text-sm text-foreground-lighter",children:t.subtitle}),(0,a.jsx)("div",{className:"text-sm flex flex-row space-x-5 py-4",children:"postgres"===t.method.type?(0,a.jsxs)("div",{className:"flex flex-col w-full space-y-2",children:[(0,a.jsxs)("div",{className:"flex flex-row items-center",children:[(0,a.jsx)("span",{className:"text-foreground-light w-20",children:"type"}),(0,a.jsx)("span",{className:"text-foreground",children:"Postgres function"})]}),(0,a.jsxs)("div",{className:"flex flex-row items-center",children:[(0,a.jsx)("span",{className:"text-foreground-light w-20",children:"schema"}),(0,a.jsx)(ee.A,{title:t.method.schema,copy:!0,readOnly:!0,disabled:!0,className:"input-mono [&>div>div>div>input]:text-xs [&>div>div>div>input]:opacity-100 flex-1",value:t.method.schema,onCopy:()=>"postgres"===t.method.type&&(0,et.l)(t.method.schema)})]}),(0,a.jsxs)("div",{className:"flex flex-row items-center",children:[(0,a.jsx)("span",{className:"text-foreground-light w-20",children:"function"}),(0,a.jsx)(ee.A,{title:t.method.functionName,copy:!0,readOnly:!0,disabled:!0,className:"input-mono [&>div>div>div>input]:text-xs [&>div>div>div>input]:opacity-100 flex-1",value:t.method.functionName,onCopy:()=>"postgres"===t.method.type&&(0,et.l)(t.method.functionName)})]})]}):(0,a.jsxs)("div",{className:"flex flex-col w-full space-y-2",children:[(0,a.jsxs)("div",{className:"flex flex-row items-center",children:[(0,a.jsx)("span",{className:"text-foreground-light w-20",children:"type"}),(0,a.jsx)("span",{className:"text-foreground",children:"HTTPS endpoint"})]}),(0,a.jsxs)("div",{className:"flex flex-row items-center",children:[(0,a.jsx)("span",{className:"text-foreground-light w-20",children:"endpoint"}),(0,a.jsx)(ee.A,{title:t.method.url,copy:!0,readOnly:!0,disabled:!0,className:"input-mono [&>div>div>div>input]:text-xs [&>div>div>div>input]:opacity-100 flex-1",value:t.method.url,onCopy:()=>"https"===t.method.type&&(0,et.l)(t.method.url)})]}),(0,a.jsxs)("div",{className:"flex flex-row items-center",children:[(0,a.jsx)("span",{className:"text-foreground-light w-20",children:"secret"}),(0,a.jsx)(ee.A,{copy:!0,title:t.method.secret,reveal:!0,readOnly:!0,disabled:!0,className:"input-mono [&>div>div>div>input]:text-xs [&>div>div>div>input]:opacity-100 flex-1",value:t.method.secret})]})]})}),(0,a.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,a.jsx)(w.G,{type:"default",disabled:!r,onClick:()=>s(),tooltip:{content:{side:"bottom",text:r?void 0:"You need additional permissions to configure auth hooks"}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"HookCard.tsx",children:"Configure hook"}),(0,a.jsx)(G.A,{href:"https://supabase.com/docs/guides/auth/auth-hooks/"+t.docSlug,"data-sentry-element":"DocsButton","data-sentry-source-file":"HookCard.tsx"})]})]}),(0,a.jsx)("div",{className:"flex-1",children:t.enabled?(0,a.jsxs)(es.E,{className:"space-x-1",variant:"brand",children:[(0,a.jsx)("div",{className:"h-3.5 w-3.5 bg-brand rounded-full flex justify-center items-center",children:(0,a.jsx)(Z.A,{className:"h-2 w-2 text-background-overlay ",strokeWidth:6})}),(0,a.jsx)("span",{children:"Enabled"})]}):(0,a.jsx)(es.E,{variant:"warning",children:(0,a.jsx)("span",{children:"Disabled"})})})]})},en=()=>{let{ref:e}=(0,o.g)(),{project:t}=(0,i.Om)(),{data:s,error:n,isError:m}=(0,h.op)({projectRef:e}),[f,x]=(0,r.useState)(null),[p,g]=(0,r.useState)(null),{mutate:N,isLoading:w}=y({onSuccess:async()=>{if(!p)return;let{method:s}=p;if("postgres"===s.type){let a=(0,E.IT)(s.schema,s.functionName);await (0,j.E)({projectRef:e,connectionString:t.connectionString,sql:a.join("\n")})}l.oR.success("".concat(p.title," has been deleted.")),g(null),x(null)},onError:e=>{l.oR.error("Failed to delete hook: ".concat(e.message))}}),S=_.map(e=>({...e,enabled:(null==s?void 0:s[e.enabledKey])||!1,method:(0,E.vw)((null==s?void 0:s[e.uriKey])||"",(null==s?void 0:s[e.secretsKey])||"")}));return m?(0,a.jsx)(d.A,{error:n,subject:"Failed to retrieve auth configuration for hooks"}):(0,a.jsxs)(c.gu,{isFullWidth:!0,"data-sentry-element":"ScaffoldSection","data-sentry-component":"HooksListing","data-sentry-source-file":"HooksListing.tsx",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)(c.sZ,{"data-sentry-element":"ScaffoldSectionTitle","data-sentry-source-file":"HooksListing.tsx",children:"All hooks"}),(0,a.jsx)(T,{onSelectHook:x,"data-sentry-element":"AddHookDropdown","data-sentry-source-file":"HooksListing.tsx"})]}),0===S.filter(e=>(0,E.U2)(e)).length&&(0,a.jsxs)("div",{className:"border rounded border-default px-20 py-16 flex flex-col items-center justify-center space-y-4",children:[(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"No hooks configured yet"}),(0,a.jsx)(T,{align:"center",buttonText:"Add a new hook",onSelectHook:x})]}),(0,a.jsx)("div",{className:"-space-y-px",children:S.filter(e=>(0,E.U2)(e)).map(e=>(0,a.jsx)(ea,{hook:e,onSelect:()=>x(e.title)},e.enabledKey))}),(0,a.jsx)(Y,{title:f,visible:!!f,onDelete:()=>{let e=S.find(e=>e.title===f);e&&g(e)},onClose:()=>x(null),authConfig:s,"data-sentry-element":"CreateHookSheet","data-sentry-source-file":"HooksListing.tsx"}),(0,a.jsx)(v.A,{visible:!!p,size:"large",variant:"destructive",loading:w,title:"Confirm to delete ".concat(null==p?void 0:p.title),confirmLabel:"Delete",confirmLabelLoading:"Deleting",onCancel:()=>g(null),onConfirm:()=>{p&&N({projectRef:e,config:{[p.enabledKey]:!1,[p.uriKey]:null,[p.secretsKey]:null}})},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"HooksListing.tsx",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-sm text-foreground-light",children:["Are you sure you want to delete the ",null==p?void 0:p.title,"?"]}),(null==p?void 0:p.method.type)==="postgres"&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("p",{className:"text-sm text-foreground-light",children:["The following statements will be executed on the"," ",null==p?void 0:p.method.schema,".",null==p?void 0:p.method.functionName," function:"]}),(0,a.jsx)("div",{className:(0,b.cn)("mt-4","h-72"),children:(0,a.jsx)(u.A,{id:"deletion-hook-editor",isReadOnly:!0,language:"pgsql",value:(0,E.IT)(null==p?void 0:p.method.schema,null==p?void 0:p.method.functionName).join("\n\n")})})]})]})})]})};var er=s(27939),el=s(62146),eo=s(12101),ei=s(98969);let ec=()=>{let e=(0,S.SE)(n.aG.READ,"custom_config_gotrue");return(0,S.Lh)()&&!e?(0,a.jsx)(ei.A,{isFullPage:!0,resourceText:"access your project's auth hooks"}):(0,a.jsx)(c.eh,{"data-sentry-element":"ScaffoldContainer","data-sentry-component":"Hooks","data-sentry-source-file":"hooks.tsx",children:(0,a.jsx)(en,{"data-sentry-element":"HooksListing","data-sentry-source-file":"hooks.tsx"})})},ed=[(0,a.jsx)(G.A,{href:"https://supabase.com/docs/guides/auth/auth-hooks"},"docs")];ec.getLayout=e=>(0,a.jsx)(el.A,{children:(0,a.jsx)(er.A,{children:(0,a.jsx)(eo.M,{title:"Auth Hooks",subtitle:"Use Postgres functions or HTTP endpoints to customize the behavior of Supabase Auth to meet your needs",secondaryActions:ed,children:e})})});let eu=ec},39358:(e,t,s)=>{"use strict";s.d(t,{O:()=>o,h:()=>l});var a=s(80263),n=s(53239),r=s(51500);let l=(0,n.forwardRef)((e,t)=>(0,a.jsx)("nav",{ref:t,dir:"ltr",...e,className:(0,r.cn)("border-b",e.className),children:(0,a.jsx)("ul",{role:"menu",className:"flex gap-5",children:e.children})})),o=(0,n.forwardRef)((e,t)=>{let{children:s,className:n,active:l,...o}=e;return(0,a.jsx)("li",{ref:t,"aria-selected":l?"true":"false","data-state":l?"active":"inactive",className:(0,r.cn)("inline-flex items-center justify-center whitespace-nowrap text-sm ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:text-foreground text-foreground-lighter hover:text-foreground data-[state=active]:border-foreground border-b-2 border-transparent *:py-1.5",n),...o,children:s})})},39551:(e,t,s)=>{"use strict";var a=s(23727),n=s(93226).Buffer,r=s.g.crypto||s.g.msCrypto;r&&r.getRandomValues?e.exports=function(e,t){if(e>0xffffffff)throw RangeError("requested too many random bytes");var s=n.allocUnsafe(e);if(e>0)if(e>65536)for(var l=0;l<e;l+=65536)r.getRandomValues(s.slice(l,l+65536));else r.getRandomValues(s);return"function"==typeof t?a.nextTick(function(){t(null,s)}):s}:e.exports=function(){throw Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}},43242:(e,t,s)=>{"use strict";s.d(t,{Ay:()=>m});var a=s(80263),n=s(53239),r=s(70800),l=s(51500),o=s(24771);function i(e){let{children:t,className:s,tag:n="div",style:r}=e;return(0,a.jsx)("".concat(n),{style:r,"data-sentry-element":"CustomTag","data-sentry-component":"Typography","data-sentry-source-file":"Typography.tsx",children:t})}i.Title=function(e){let{className:t,level:s=1,children:n,style:r}=e;return(0,a.jsx)("h".concat(s),{style:r,"data-sentry-element":"CustomTag","data-sentry-component":"Title","data-sentry-source-file":"Title.tsx",children:n})},i.Text=function(e){let{className:t,children:s,style:n,type:r,disabled:l,mark:o,code:i,keyboard:c,underline:d,strikethrough:u,strong:h,small:m}=e;return i?(0,a.jsx)("code",{style:n,children:s}):o?(0,a.jsx)("mark",{style:n,children:s}):c?(0,a.jsx)("kbd",{style:n,children:s}):h?(0,a.jsx)("strong",{style:n,children:s}):(0,a.jsx)("span",{style:n,"data-sentry-component":"Text","data-sentry-source-file":"Text.tsx",children:s})},i.Link=o.A;let c=(0,n.createContext)({type:"text"}),d=e=>{let{type:t}=e;return(0,a.jsx)(c.Provider,{value:{type:t},"data-sentry-element":"unknown","data-sentry-component":"MenuContextProvider","data-sentry-source-file":"MenuContext.tsx",children:e.children})},u=()=>{let e=(0,n.useContext)(c);if(void 0===e)throw Error("MenuContext must be used within a MenuContextProvider.");return e};function h(e){let{children:t,className:s,ulClassName:n,style:r,type:l="text"}=e;return(0,a.jsx)("nav",{role:"menu","aria-label":"Sidebar","aria-orientation":"vertical","aria-labelledby":"options-menu",className:s,style:r,"data-sentry-component":"Menu","data-sentry-source-file":"Menu.tsx",children:(0,a.jsx)(d,{type:l,"data-sentry-element":"MenuContextProvider","data-sentry-source-file":"Menu.tsx",children:(0,a.jsx)("ul",{className:n,children:t})})})}h.Item=function(e){let{children:t,icon:s,active:n,rounded:o,onClick:i,doNotCloseOverlay:c=!1,showActiveBar:d=!1,style:h}=e,m=(0,r.A)("menu"),{type:f}=u(),x=[m.item.base];x.push(m.item.variants[f].base),n?x.push(m.item.variants[f].active):x.push(m.item.variants[f].normal);let p=[m.item.content.base];n?p.push(m.item.content.active):p.push(m.item.content.normal);let g=[m.item.icon.base];return n?g.push(m.item.icon.active):g.push(m.item.icon.normal),(0,a.jsxs)("li",{role:"menuitem",className:(0,l.cn)("outline-none",x),style:h,onClick:i,"aria-current":n?"page":void 0,"data-sentry-component":"Item","data-sentry-source-file":"Menu.tsx",children:[s&&(0,a.jsx)("div",{className:"".concat(g.join(" ")," min-w-fit"),children:s}),(0,a.jsx)("span",{className:p.join(" "),children:t})]})},h.Group=function(e){let{children:t,icon:s,title:n}=e,l=(0,r.A)("menu"),{type:o}=u();return(0,a.jsxs)("div",{className:[l.group.base,l.group.variants[o]].join(" "),"data-sentry-component":"Group","data-sentry-source-file":"Menu.tsx",children:[s&&(0,a.jsx)("span",{className:l.group.icon,children:s}),(0,a.jsx)("span",{className:l.group.content,children:n}),t]})},h.Misc=function(e){let{children:t}=e;return(0,a.jsx)("div",{"data-sentry-component":"Misc","data-sentry-source-file":"Menu.tsx",children:(0,a.jsx)(i.Text,{"data-sentry-element":"unknown","data-sentry-source-file":"Menu.tsx",children:(0,a.jsx)("span",{children:t})})})};let m=h},59350:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(15740).A)("Webhook",[["path",{d:"M18 16.98h-5.99c-1.1 0-1.95.94-2.48 1.9A4 4 0 0 1 2 17c.01-.7.2-1.4.57-2",key:"q3hayz"}],["path",{d:"m6 17 3.13-5.78c.53-.97.1-2.18-.5-3.1a4 4 0 1 1 6.89-4.06",key:"1go1hn"}],["path",{d:"m12 6 3.13 5.73C15.66 12.7 16.9 13 18 13a4 4 0 0 1 0 8",key:"qlwsc0"}]])},73047:(e,t,s)=>{"use strict";s.d(t,{A:()=>c});var a=s(80263),n=s(15601),r=s.n(n),l=s(43242),o=s(2119),i=s(40022);let c=e=>{let{name:t="",isActive:s,isExternal:n,icon:c,rightIcon:d,url:u="",target:h="_self",onClick:m,textClassName:f="",hoverText:x="",label:p}=e,g=(0,a.jsx)(l.Ay.Item,{icon:c,rounded:!0,active:s,onClick:m,children:(0,a.jsxs)("div",{className:"flex w-full items-center justify-between gap-1",children:[(0,a.jsxs)("div",{title:x||("string"==typeof t?t:""),className:"flex items-center gap-2 truncate w-full "+f,children:[(0,a.jsxs)("span",{className:"truncate",children:[t," "]}),void 0!==p&&(0,a.jsx)(o.E,{variant:"warning",className:"py-0 px-1.5 capitalize",children:p})]}),d&&(0,a.jsx)("div",{children:d})]})});return u?n?(0,a.jsx)(i.$,{asChild:!0,block:!0,className:"!justify-start",type:"text",size:"small",icon:c,children:(0,a.jsx)(r(),{href:u,target:"_blank",rel:"noreferrer",children:t})}):(0,a.jsx)(r(),{href:u,className:"block",target:h,children:g}):g}},79015:(e,t,s)=>{"use strict";s.d(t,{A:()=>y});var a=s(80263),n=s(60045),r=s(96572),l=s(80903),o=s(3689),i=s(53239),c=s(98832),d=s(63604),u=s(75019),h=s(40022),m=s(53555),f=s(1012),x=s(9681),p=s(61965),g=s(80016);let y=e=>{let{className:t,disabled:s=!1,size:y="tiny",showError:j=!0,selectedSchemaName:b,supportSelectAll:v=!1,excludedSchemas:N=[],onSelectSchema:w,onSelectCreateSchema:S,portal:k=!0}=e,[A,C]=(0,i.useState)(!1),_=(0,u.SE)(n.aG.TENANT_SQL_ADMIN_WRITE,"schemas"),{project:E}=(0,c.Om)(),{data:T,isLoading:R,isSuccess:O,isError:H,error:M,refetch:K}=(0,d.w$)({projectRef:null==E?void 0:E.ref,connectionString:null==E?void 0:E.connectionString}),I=(T||[]).filter(e=>!N.includes(e.name)).sort((e,t)=>e.name.localeCompare(t.name));return(0,a.jsxs)("div",{className:t,"data-sentry-component":"SchemaSelector","data-sentry-source-file":"SchemaSelector.tsx",children:[R&&(0,a.jsx)(h.$,{type:"default",className:"w-full [&>span]:w-full",size:y,disabled:!0,children:(0,a.jsx)(m.E,{className:"w-full h-3 bg-foreground-muted"})},"schema-selector-skeleton"),j&&H&&(0,a.jsxs)(f.Fc,{variant:"warning",className:"!px-3 !py-3",children:[(0,a.jsx)(f.XL,{className:"text-xs text-amber-900",children:"Failed to load schemas"}),(0,a.jsxs)(f.TN,{className:"text-xs mb-2 break-words",children:["Error: ",null==M?void 0:M.message]}),(0,a.jsx)(h.$,{type:"default",size:"tiny",onClick:()=>K(),children:"Reload schemas"})]}),O&&(0,a.jsxs)(x.AM,{open:A,onOpenChange:C,modal:!1,children:[(0,a.jsx)(x.Wv,{asChild:!0,children:(0,a.jsx)(h.$,{size:y,disabled:s,type:"default","data-testid":"schema-selector",className:"w-full [&>span]:w-full !pr-1 space-x-1",iconRight:(0,a.jsx)(r.A,{className:"text-foreground-muted",strokeWidth:2,size:14}),children:b?(0,a.jsxs)("div",{className:"w-full flex gap-1",children:[(0,a.jsx)("p",{className:"text-foreground-lighter",children:"schema"}),(0,a.jsx)("p",{className:"text-foreground",children:"*"===b?"All schemas":b})]}):(0,a.jsx)("div",{className:"w-full flex gap-1",children:(0,a.jsx)("p",{className:"text-foreground-lighter",children:"Choose a schema…"})})})}),(0,a.jsx)(x.hl,{className:"p-0 min-w-[200px] pointer-events-auto",side:"bottom",align:"start",portal:k,sameWidthAsTrigger:!0,children:(0,a.jsxs)(p.uB,{children:[(0,a.jsx)(p.G7,{placeholder:"Find schema..."}),(0,a.jsxs)(p.oI,{children:[(0,a.jsx)(p.xL,{children:"No schemas found"}),(0,a.jsx)(p.L$,{children:(0,a.jsxs)(g.FK,{className:(I||[]).length>7?"h-[210px]":"",children:[v&&(0,a.jsxs)(p.h_,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{w("*"),C(!1)},onClick:()=>{w("*"),C(!1)},children:[(0,a.jsx)("span",{children:"All schemas"}),"*"===b&&(0,a.jsx)(l.A,{className:"text-brand",strokeWidth:2,size:16})]},"select-all"),null==I?void 0:I.map(e=>(0,a.jsxs)(p.h_,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{w(e.name),C(!1)},onClick:()=>{w(e.name),C(!1)},children:[(0,a.jsx)("span",{children:e.name}),b===e.name&&(0,a.jsx)(l.A,{className:"text-brand",strokeWidth:2,size:16})]},e.id))]})}),void 0!==S&&_&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.fx,{}),(0,a.jsx)(p.L$,{children:(0,a.jsxs)(p.h_,{className:"cursor-pointer flex items-center gap-x-2 w-full",onSelect:()=>{S(),C(!1)},onClick:()=>{S(),C(!1)},children:[(0,a.jsx)(o.A,{size:12}),"Create a new schema"]})})]})]})]})})]})]})}},86889:(e,t,s)=>{"use strict";s.d(t,{IT:()=>r,U2:()=>n,vw:()=>a});let a=(e,t)=>{if(e.startsWith("https"))return{type:"https",url:e,secret:t||""};{let[t,s,a,n,r]=(e||"").split("/");return{type:"postgres",schema:n||"",functionName:r||""}}},n=e=>"postgres"===e.method.type&&e.method.schema.length>0&&e.method.functionName.length>0||"https"===e.method.type&&e.method.url.startsWith("https")&&e.method.secret.length>0,r=(e,t)=>["-- Revoke access to function from supabase_auth_admin\nrevoke execute on function ".concat(e,".").concat(t," from supabase_auth_admin;"),"-- Revoke access to schema from supabase_auth_admin\nrevoke usage on schema ".concat(e," from supabase_auth_admin;"),"-- Restore function permissions to authenticated, anon and public\ngrant execute on function ".concat(e,".").concat(t," to authenticated, anon, public;")]},89846:(e,t,s)=>{"use strict";s.d(t,{A:()=>v});var a=s(80263),n=s(86727),r=s.n(n),l=s(96572),o=s(80903),i=s(3689),c=s(53239),d=s(98832),u=s(92303),h=s(40022),m=s(1012),f=s(9681),x=s(61965),p=s(80016),g=s(24400),y=s(15601),j=s.n(y),b=s(90478);let v=e=>{let{className:t,size:s="tiny",showError:n=!0,disabled:y=!1,schema:v,value:N,onChange:w,filterFunction:S=()=>!0,noResultsLabel:k=(0,a.jsx)("span",{children:"No functions found in this schema."})}=e,A=(0,g.useRouter)(),{ref:C}=(0,b.g)(),{project:_}=(0,d.Om)(),[E,T]=(0,c.useState)(!1),{data:R,error:O,isLoading:H,isError:M,isSuccess:K,refetch:I}=(0,u.e)({projectRef:null==_?void 0:_.ref,connectionString:null==_?void 0:_.connectionString}),L=(null!=R?R:[]).filter(e=>v&&e.schema===v).filter(S),V=r()(L,e=>e.name);return(0,a.jsxs)("div",{className:t,"data-sentry-component":"FunctionSelector","data-sentry-source-file":"FunctionSelector.tsx",children:[H&&(0,a.jsx)(h.$,{type:"default",className:"justify-start",block:!0,size:s,loading:!0,children:"Loading functions..."}),n&&M&&(0,a.jsxs)(m.Fc,{variant:"warning",className:"!px-3 !py-3",children:[(0,a.jsx)(m.XL,{className:"text-xs text-amber-900",children:"Failed to load functions"}),(0,a.jsxs)(m.TN,{className:"text-xs mb-2",children:["Error: ",O.message]}),(0,a.jsx)(h.$,{type:"default",size:"tiny",onClick:()=>I(),children:"Reload functions"})]}),K&&(0,a.jsxs)(f.AM,{open:E,onOpenChange:T,modal:!1,children:[(0,a.jsx)(f.Wv,{asChild:!0,children:(0,a.jsx)(h.$,{size:s,disabled:!!y,type:"default",className:"w-full [&>span]:w-full ".concat("small"===s?"py-1.5":""),iconRight:(0,a.jsx)(l.A,{className:"text-foreground-muted",strokeWidth:2,size:14}),children:N?(0,a.jsxs)("div",{className:"w-full flex gap-1",children:[(0,a.jsx)("p",{className:"text-foreground-lighter",children:"function:"}),(0,a.jsx)("p",{className:"text-foreground",children:N})]}):(0,a.jsx)("div",{className:"w-full flex gap-1",children:(0,a.jsx)("p",{className:"text-foreground-lighter",children:"Select a function"})})})}),(0,a.jsx)(f.hl,{className:"p-0",side:"bottom",align:"start",sameWidthAsTrigger:!0,children:(0,a.jsxs)(x.uB,{children:[(0,a.jsx)(x.G7,{placeholder:"Search functions..."}),(0,a.jsxs)(x.oI,{children:[(0,a.jsx)(x.xL,{children:"No functions found"}),(0,a.jsx)(x.L$,{children:(0,a.jsxs)(p.FK,{className:(V||[]).length>7?"h-[210px]":"",children:[!V.length&&(0,a.jsx)(x.h_,{disabled:!0,className:"flex items-center justify-between space-x-2 w-full",children:k},"no-function-found"),V.map(e=>(0,a.jsxs)(x.h_,{value:e.name.replaceAll('"',""),className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{w(e.name),T(!1)},onClick:()=>{w(e.name),T(!1)},children:[(0,a.jsx)("span",{children:e.name}),N===e.name&&(0,a.jsx)(o.A,{className:"text-brand",size:14,strokeWidth:2})]},e.id))]})}),(0,a.jsx)(x.fx,{}),(0,a.jsx)(x.L$,{children:(0,a.jsx)(x.h_,{className:"cursor-pointer w-full",onSelect:()=>{T(!1),A.push("/project/".concat(C,"/database/functions"))},onClick:()=>T(!1),children:(0,a.jsxs)(j(),{href:"/project/".concat(C,"/database/functions"),onClick:()=>{T(!1)},className:"w-full flex items-center gap-2",children:[(0,a.jsx)(i.A,{size:14,strokeWidth:1.5}),(0,a.jsx)("p",{children:"New function"})]})})})]})]})})]})]})}},90226:(e,t,s)=>{"use strict";s.d(t,{l:()=>o});var a=s(80263),n=s(43242),r=s(2119),l=s(73047);let o=e=>{let{page:t,menu:s}=e;return(0,a.jsx)("div",{className:"flex flex-col space-y-8 overflow-y-auto","data-sentry-component":"ProductMenu","data-sentry-source-file":"ProductMenu.tsx",children:(0,a.jsx)(n.Ay,{type:"pills","data-sentry-element":"Menu","data-sentry-source-file":"ProductMenu.tsx",children:s.map((e,o)=>(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"my-6 space-y-8",children:(0,a.jsxs)("div",{className:"mx-3",children:[(0,a.jsx)(n.Ay.Group,{title:e.title?(0,a.jsxs)("div",{className:"flex flex-col space-y-2 uppercase font-mono",children:[(0,a.jsx)("span",{children:e.title}),e.isPreview&&(0,a.jsx)(r.E,{variant:"warning",children:"Not production ready"})]}):null}),(0,a.jsx)("div",{children:e.items.map(e=>{let s=e.pages?e.pages.includes(null!=t?t:""):t===e.key;return(0,a.jsx)(l.A,{url:e.url,name:e.name,icon:e.icon,rightIcon:e.rightIcon,isActive:s,isExternal:e.isExternal,target:e.isExternal?"_blank":"_self",label:e.label},e.key)})})]})}),o!==s.length-1&&(0,a.jsx)("div",{className:"h-px w-full bg-border-overlay"})]},e.key||e.title))})})}},92303:(e,t,s)=>{"use strict";s.d(t,{e:()=>c});var a=s(47319),n=s(56947),r=s(92403),l=s(15629);let o=a.A.functions.list();async function i(e,t,s){let{projectRef:a,connectionString:n}=e,r=new Headers(s),{result:i}=await (0,l.E)({projectRef:a,connectionString:n,sql:o.sql,queryKey:["database-functions"]},t,r);return i}let c=function(e){let{projectRef:t,connectionString:s}=e,{enabled:a=!0,...l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,n.I)(r.c.databaseFunctions(t),e=>{let{signal:a}=e;return i({projectRef:t,connectionString:s},a)},{enabled:a&&void 0!==t,...l})}},92882:(e,t,s)=>{"use strict";s.d(t,{BS:()=>o,Dm:()=>d,HJ:()=>j,Rf:()=>g,Uw:()=>c,Vw:()=>N,Xr:()=>v,aw:()=>x,bV:()=>l,cJ:()=>m,dX:()=>u,eh:()=>i,fh:()=>b,gu:()=>h,sZ:()=>f,tn:()=>y,xp:()=>p});var a=s(80263),n=s(53239),r=s(51500);let l="mx-auto w-full max-w-[1200px]",o="px-4 @lg:px-6 @xl:px-12 @2xl:px-20 @3xl:px-24",i=(0,n.forwardRef)((e,t)=>{let{className:s,bottomPadding:n,size:l="default",...i}=e;return(0,a.jsx)("div",{ref:t,...i,className:(0,r.cn)("mx-auto w-full",{small:"max-w-[768px]",default:"max-w-[1200px]",large:"max-w-[1600px]",full:"max-w-none"}[l],o,n&&"pb-16",s)})}),c=(0,n.forwardRef)((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("header",{...n,ref:t,className:(0,r.cn)("w-full","flex-col gap-3 py-6",s)})}),d=(0,n.forwardRef)((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("h1",{ref:t,...n,className:(0,r.cn)("text-2xl",s)})}),u=(0,n.forwardRef)((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("p",{ref:t,...n,className:(0,r.cn)("text-sm text-foreground-light",s)})}),h=(0,n.forwardRef)((e,t)=>{let{className:s,isFullWidth:n,topPadding:l,...o}=e;return(0,a.jsx)("div",{ref:t,...o,className:(0,r.cn)("flex flex-col first:pt-12 py-6",n?"w-full":"gap-3 lg:grid md:grid-cols-12",s)})}),m=(0,n.forwardRef)((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,...n,className:(0,r.cn)("w-full h-px bg-border",s)})}),f=(0,n.forwardRef)((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("h3",{ref:t,...n,className:(0,r.cn)("text-foreground text-xl",s)})}),x=(0,n.forwardRef)((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("p",{ref:t,...n,className:(0,r.cn)("text-sm text-foreground-light",s)})}),p=(0,n.forwardRef)((e,t)=>{let{className:s,children:n,title:l,...o}=e;return(0,a.jsxs)("div",{ref:t,...o,className:(0,r.cn)("col-span-4 xl:col-span-5 prose text-sm",s),children:[l&&(0,a.jsx)("h2",{children:l}),n]})}),g=(0,n.forwardRef)((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,...n,className:(0,r.cn)("col-span-8 xl:col-span-7","flex flex-col gap-6",s)})}),y=(0,n.forwardRef)((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,...n,className:(0,r.cn)("flex flex-col gap-3 items-center",s)})}),j=(0,n.forwardRef)((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,...n,className:(0,r.cn)("flex w-full items-center",s)})}),b=(0,n.forwardRef)((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,...n,className:(0,r.cn)("flex flex-row gap-3",s)})}),v=(0,n.forwardRef)((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,...n,className:(0,r.cn)("flex flex-col gap-3","min-w-[420px]",s)})}),N=(0,n.forwardRef)((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,...n,className:(0,r.cn)(l,o,"my-8 flex flex-col gap-8",s)})});c.displayName="ScaffoldHeader",d.displayName="ScaffoldTitle",u.displayName="ScaffoldDescription",i.displayName="ScaffoldContainer",m.displayName="ScaffoldDivider",h.displayName="ScaffoldSection",v.displayName="ScaffoldColumn",p.displayName="ScaffoldSectionDetail",g.displayName="ScaffoldSectionContent",y.displayName="ScaffoldFilterAndContent",j.displayName="ScaffoldActionsContainer",b.displayName="ScaffoldActionsGroup",N.displayName="ScaffoldContainerLegacy",f.displayName="ScaffoldSectionTitle",x.displayName="ScaffoldSectionDescription"},93226:(e,t,s)=>{var a=s(15599),n=a.Buffer;function r(e,t){for(var s in e)t[s]=e[s]}function l(e,t,s){return n(e,t,s)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=a:(r(a,t),t.Buffer=l),l.prototype=Object.create(n.prototype),r(n,l),l.from=function(e,t,s){if("number"==typeof e)throw TypeError("Argument must not be a number");return n(e,t,s)},l.alloc=function(e,t,s){if("number"!=typeof e)throw TypeError("Argument must be a number");var a=n(e);return void 0!==t?"string"==typeof s?a.fill(t,s):a.fill(t):a.fill(0),a},l.allocUnsafe=function(e){if("number"!=typeof e)throw TypeError("Argument must be a number");return n(e)},l.allocUnsafeSlow=function(e){if("number"!=typeof e)throw TypeError("Argument must be a number");return a.SlowBuffer(e)}},96469:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/auth/hooks",function(){return s(36729)}])},97344:(e,t,s)=>{var a=s(58381),n=s(51276),r=s(5689),l=s(33312),o=s(89527),i=s(79661),c=s(86458),d=s(63570),u=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(o(e)&&(l(e)||"string"==typeof e||"function"==typeof e.splice||i(e)||d(e)||r(e)))return!e.length;var t=n(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(c(e))return!a(e).length;for(var s in e)if(u.call(e,s))return!1;return!0}},98969:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var a=s(80263),n=s(87610);let r=e=>{let{resourceText:t,isFullPage:s=!1}=e,r=()=>(0,a.jsx)("div",{className:"block w-full rounded border border-opacity-20 py-4 px-6 border-overlay bg-surface-200","data-sentry-component":"NoPermissionMessage","data-sentry-source-file":"NoPermission.tsx",children:(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("div",{className:"mt-1",children:(0,a.jsx)(n.A,{size:20,"data-sentry-element":"AlertCircle","data-sentry-source-file":"NoPermission.tsx"})}),(0,a.jsx)("div",{className:"flex w-full items-center justify-between",children:(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("p",{className:"text-sm",children:["You need additional permissions to ",t]}),(0,a.jsx)("div",{children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Contact your organization owner or administrator for assistance."})})]})})]})});return s?(0,a.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,a.jsx)("div",{className:"w-[550px]",children:(0,a.jsx)(r,{})})}):(0,a.jsx)(r,{})}}},e=>{var t=t=>e(e.s=t);e.O(0,[89,726,4280,3730,2981,6110,386,7661,5599,8445,4849,3019,1680,7654,8274,6,3634,5007,4017,890,9014,7795,4444,7182,1715,8821,1099,2146,5756,8098,6593,636,8792],()=>t(96469)),_N_E=e.O()}]);