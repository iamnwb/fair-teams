!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="b3465e36-860f-46d8-a302-e272a7ba8180",e._sentryDebugIdIdentifier="sentry-dbid-b3465e36-860f-46d8-a302-e272a7ba8180")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3374],{5043:(e,n,t)=>{t.d(n,{Lh:()=>u,T_:()=>h});var a=t(32144),o=t(80251),s=t(73969),r=t(26616),i=t.n(r),l=t(15629),c=t(48054),d=t(92403);let u="pgmq_public",m=i()("\ncreate schema if not exists ".concat(u,";\ngrant usage on schema ").concat(u," to postgres, anon, authenticated, service_role;\n\ncreate or replace function ").concat(u,".pop(\n    queue_name text\n)\n  returns setof pgmq.message_record\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return query\n    select *\n    from pgmq.pop(\n        queue_name := queue_name\n    );\nend;\n$$;\n\ncomment on function ").concat(u,".pop(queue_name text) is 'Retrieves and locks the next message from the specified queue.';\n\n\ncreate or replace function ").concat(u,".send(\n    queue_name text,\n    message jsonb,\n    sleep_seconds integer default 0  -- renamed from 'delay'\n)\n  returns setof bigint\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return query\n    select *\n    from pgmq.send(\n        queue_name := queue_name,\n        msg := message,\n        delay := sleep_seconds\n    );\nend;\n$$;\n\ncomment on function ").concat(u,".send(queue_name text, message jsonb, sleep_seconds integer) is 'Sends a message to the specified queue, optionally delaying its availability by a number of seconds.';\n\n\ncreate or replace function ").concat(u,".send_batch(\n    queue_name text,\n    messages jsonb[],\n    sleep_seconds integer default 0  -- renamed from 'delay'\n)\n  returns setof bigint\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return query\n    select *\n    from pgmq.send_batch(\n        queue_name := queue_name,\n        msgs := messages,\n        delay := sleep_seconds\n    );\nend;\n$$;\n\ncomment on function ").concat(u,".send_batch(queue_name text, messages jsonb[], sleep_seconds integer) is 'Sends a batch of messages to the specified queue, optionally delaying their availability by a number of seconds.';\n\n\ncreate or replace function ").concat(u,".archive(\n    queue_name text,\n    message_id bigint\n)\n  returns boolean\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return\n    pgmq.archive(\n        queue_name := queue_name,\n        msg_id := message_id\n    );\nend;\n$$;\n\ncomment on function ").concat(u,".archive(queue_name text, message_id bigint) is 'Archives a message by moving it from the queue to a permanent archive.';\n\n\ncreate or replace function ").concat(u,".delete(\n    queue_name text,\n    message_id bigint\n)\n  returns boolean\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return\n    pgmq.delete(\n        queue_name := queue_name,\n        msg_id := message_id\n    );\nend;\n$$;\n\ncomment on function ").concat(u,".delete(queue_name text, message_id bigint) is 'Permanently deletes a message from the specified queue.';\n\ncreate or replace function ").concat(u,".read(\n    queue_name text,\n    sleep_seconds integer,\n    n integer\n)\n  returns setof pgmq.message_record\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return query\n    select *\n    from pgmq.read(\n        queue_name := queue_name,\n        vt := sleep_seconds,\n        qty := n\n    );\nend;\n$$;\n\ncomment on function ").concat(u,'.read(queue_name text, sleep_seconds integer, n integer) is \'Reads up to "n" messages from the specified queue with an optional "sleep_seconds" (visibility timeout).\';\n\n-- Grant execute permissions on wrapper functions to roles\ngrant execute on function ').concat(u,".pop(text) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.pop(text) to postgres, service_role, anon, authenticated;\n\ngrant execute on function ").concat(u,".send(text, jsonb, integer) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.send(text, jsonb, integer) to postgres, service_role, anon, authenticated;\n\ngrant execute on function ").concat(u,".send_batch(text, jsonb[], integer) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.send_batch(text, jsonb[], integer) to postgres, service_role, anon, authenticated;\n\ngrant execute on function ").concat(u,".archive(text, bigint) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.archive(text, bigint) to postgres, service_role, anon, authenticated;\n\ngrant execute on function ").concat(u,".delete(text, bigint) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.delete(text, bigint) to postgres, service_role, anon, authenticated;\n\ngrant execute on function ").concat(u,".read(text, integer, integer) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.read(text, integer, integer) to postgres, service_role, anon, authenticated;\n\n-- For the service role, we want full access\n-- Grant permissions on existing tables\ngrant all privileges on all tables in schema pgmq to postgres, service_role;\n\n-- Ensure service_role has permissions on future tables\nalter default privileges in schema pgmq grant all privileges on tables to postgres, service_role;\n\ngrant usage on schema pgmq to postgres, anon, authenticated, service_role;\n\n\n/*\n  Grant access to sequences to API roles by default. Existing table permissions\n  continue to enforce insert restrictions. This is necessary to accommodate the\n  on-backup hook that rebuild queue table primary keys to avoid a pg_dump segfault.\n  This can be removed once logical backups are completely retired.\n*/\ngrant usage, select, update\non all sequences in schema pgmq\nto anon, authenticated, service_role;\n\nalter default privileges in schema pgmq\ngrant usage, select, update\non sequences\nto anon, authenticated, service_role;\n")),p=i()("\n  drop function if exists \n    ".concat(u,".pop(queue_name text),\n    ").concat(u,".send(queue_name text, message jsonb, sleep_seconds integer),\n    ").concat(u,".send_batch(queue_name text, message jsonb[], sleep_seconds integer),\n    ").concat(u,".archive(queue_name text, message_id bigint),\n    ").concat(u,".delete(queue_name text, message_id bigint),\n    ").concat(u,".read(queue_name text, sleep integer, n integer)\n  ;\n\n  -- Revoke execute permissions on inner pgmq functions to roles (inverse of enabling)\n  do $$\n  begin\n      if exists (select 1 from pg_namespace where nspname = 'pgmq') then\n          -- Revoke privileges on the schema itself\n          revoke all on schema pgmq from anon, authenticated, service_role;\n          \n          -- Revoke default privileges for future objects\n          alter default privileges in schema pgmq revoke all on tables from anon, authenticated, service_role;\n          alter default privileges in schema pgmq revoke all on sequences from anon, authenticated, service_role;\n          alter default privileges in schema pgmq revoke all on functions from anon, authenticated, service_role;\n      end if;\n  end $$;\n\n  drop schema if exists ").concat(u,";\n"));async function g(e){let{projectRef:n,connectionString:t,enable:a}=e,{result:o}=await (0,l.E)({projectRef:n,connectionString:t,sql:a?m:p,queryKey:["toggle-queues-exposure"]});return o}let h=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,a.jE)();return(0,o.n)(e=>g(e),{async onSuccess(n,t,a){let{projectRef:o}=t;await r.invalidateQueries(c.m.exposePostgrestStatus(o)),r.invalidateQueries(d.c.schemas(o)),await (null==e?void 0:e(n,t,a))},async onError(e,t,a){void 0===n?s.oR.error("Failed to toggle queue exposure via PostgREST: ".concat(e.message)):n(e,t,a)},...t})}},9082:(e,n,t)=>{t.d(n,{i:()=>a});let a={tableEditor:(e,n)=>["projects",e,"table-editor",n].filter(Boolean)}},12006:(e,n,t)=>{t.d(n,{RB:()=>i,ov:()=>l});var a=t(56947),o=t(15629),s=t(48895);let r=()=>"\n    select\n      s.oid as \"id\",\n      w.fdwname as \"name\",\n      s.srvname as \"server_name\",\n      s.srvoptions as \"server_options\",\n      c.proname as \"handler\",\n      (\n        select jsonb_agg(\n          jsonb_build_object(\n            'id', c.oid::bigint,\n            'schema', relnamespace::regnamespace::text,\n            'name', c.relname,\n            'columns', (\n              select jsonb_agg(\n                jsonb_build_object(\n                  'name', a.attname,\n                  'type', pg_catalog.format_type(a.atttypid, a.atttypmod)\n                )\n              )\n              from pg_catalog.pg_attribute a\n              where a.attrelid = c.oid and a.attnum > 0 and not a.attisdropped\n            ),\n            'options', t.ftoptions\n          )\n        )\n        from pg_catalog.pg_class c\n        join pg_catalog.pg_foreign_table t on c.oid = t.ftrelid\n        where c.oid = any (select t.ftrelid from pg_catalog.pg_foreign_table t where t.ftserver = s.oid)\n      ) as \"tables\"\n    from pg_catalog.pg_foreign_server s\n    join pg_catalog.pg_foreign_data_wrapper w on s.srvfdw = w.oid\n    join pg_catalog.pg_proc c on w.fdwhandler = c.oid;\n  ";async function i(e,n){let{projectRef:t,connectionString:a}=e,s=r(),{result:i}=await (0,o.E)({projectRef:t,connectionString:a,sql:s,queryKey:["fdws"]},n);return i}let l=function(e){let{projectRef:n,connectionString:t}=e,{enabled:o=!0,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.I)(s.Y.list(n),e=>{let{signal:a}=e;return i({projectRef:n,connectionString:t},a)},{enabled:o&&void 0!==n,...r})}},14528:(e,n,t)=>{t.d(n,{A:()=>m});var a=t(80263),o=t(58378),s=t(69724),r=t(23445),i=t(15601),l=t.n(i),c=t(53239),d=t(40022);let u=(0,c.forwardRef)((e,n)=>{let{icon:t,title:i,description:u,url:m,urlLabel:p="Read more",defaultVisibility:g=!1,hideCollapse:h=!1,button:_,className:f="",block:b=!1}=e,[y,v]=(0,c.useState)(g);return(0,a.jsx)("div",{ref:n,role:"alert",className:"".concat(b?"block w-full":"","\n      block w-full rounded-md border bg-surface-300/25 py-3 ").concat(f),children:(0,a.jsxs)("div",{className:"flex flex-col px-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex w-full space-x-3 items-center",children:[t&&(0,a.jsx)("span",{className:"text-foreground-lighter",children:t}),(0,a.jsx)("div",{className:"flex-grow",children:(0,a.jsx)("h5",{className:"text-sm text-foreground",children:i})})]}),u&&!h?(0,a.jsx)("div",{className:"cursor-pointer text-foreground-lighter",onClick:()=>v(!y),children:y?(0,a.jsx)(o.A,{size:14,strokeWidth:1.5}):(0,a.jsx)(s.A,{size:14,strokeWidth:1.5})}):null]}),(u||m||_)&&(0,a.jsxs)("div",{className:"flex flex-col space-y-3 overflow-hidden transition-all ".concat(y?"mt-3":""),style:{maxHeight:500*!!y},children:[(0,a.jsx)("div",{className:"text-foreground-light text-sm",children:u}),m&&(0,a.jsx)("div",{children:(0,a.jsx)(d.$,{asChild:!0,type:"default",icon:(0,a.jsx)(r.A,{}),children:(0,a.jsx)(l(),{href:m,target:"_blank",rel:"noreferrer",children:p})})}),_&&(0,a.jsx)("div",{children:_})]})]})})});u.displayName="InformationBox";let m=u},15713:(e,n,t)=>{t.d(n,{HQ:()=>y,nk:()=>w,vs:()=>x});var a=t(64813),o=t(24677),s=t(32144),r=t(56947),i=t(90478),l=t(76129),c=t(43089),d=t(667),u=t(66628),m=t(15629),p=t(22918),g=t(23183),h=t(46144);let _=e=>{var n;let t=e.columns.filter(e=>null==e?void 0:e.isPrimaryKey).map(e=>e.name);return 0!==t.length?t:[null==(n=e.columns[0])?void 0:n.name]};async function f(e){return new Promise(n=>setTimeout(n,e))}async function b(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:500;for(let o=0;o<=n;o++)try{return await e()}catch(e){if((null==e?void 0:e.status)===429&&o<n){var a;let n=null==(a=e.headers)?void 0:a.get("retry-after"),s=n?1e3*parseInt(n):t*Math.pow(2,o);await f(s);continue}throw e}throw Error("Max retries reached without success")}let y=async e=>{var n;let{projectRef:t,connectionString:o,table:s,filters:r=[],sorts:l=[],roleImpersonationState:c,progressCallback:u}=e;if(i.pe&&!o)return console.error("Connection string is required"),[];let p=[],y=new a.Query,v=s.columns.filter(e=>{var n;return(null!=(n=null==e?void 0:e.enum)?n:[]).length>0&&"array"===e.dataType.toLowerCase()}).map(e=>'"'.concat(e.name,'"::text[]')),x=y.from(s.name,null!=(n=s.schema)?n:void 0).select(v.length>0?"*,".concat(v.join(",")):"*");if(r.filter(e=>e.value&&""!==e.value).forEach(e=>{let n=(0,h.b)(s,e);x=x.filter(e.column,e.operator,n)}),0===l.length&&s.estimateRowCount<=g.kd){let e=_(s);e.length>0&&e.forEach(e=>{x=x.order(s.name,e)})}else l.forEach(e=>{x=x.order(e.table,e.column,e.ascending,e.nullsFirst)});let w=-1;for(;;){let e=500*(w+=1),n=(w+1)*500-1,a=(0,d.Nf)(x.range(e,n).toSql(),c);try{let{result:e}=await b(async()=>(0,m.E)({projectRef:t,connectionString:o,sql:a}));if(p.push(...e),null==u||u(p.length),e.length<500)break;await f(500)}catch(e){throw Error("Error fetching all table rows: ".concat(e instanceof Error?e.message:"Unknown error"))}}return p.filter(e=>1!==e[d.BO])};async function v(e,n){let{queryClient:t,projectRef:a,connectionString:s,tableId:r,roleImpersonationState:i,filters:p,sorts:g,limit:h,page:_}=e,f=await (0,c.Nj)(t,{projectRef:a,connectionString:s,id:r});if(!f)throw Error("Table not found");let b=(0,l.rH)(f),y=(0,d.Nf)((0,o.yG)({table:f,filters:p,sorts:g,limit:h,page:_}),i);try{let{result:e}=await (0,m.E)({projectRef:a,connectionString:s,sql:y,queryKey:["table-rows",null==b?void 0:b.id],isRoleImpersonationEnabled:(0,u._c)(null==i?void 0:i.role)},n);return{rows:e.map((e,n)=>({idx:n,...e}))}}catch(e){throw Error("Error fetching table rows: ".concat(e instanceof Error?e.message:"Unknown error"))}}let x=function(e){let{projectRef:n,connectionString:t,tableId:a,...o}=e,{enabled:i=!0,...l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=(0,s.jE)();return(0,r.I)(p.j.tableRows(n,{table:{id:a},...o}),e=>{let{signal:s}=e;return v({queryClient:c,projectRef:n,connectionString:t,tableId:a,...o},s)},{enabled:i&&void 0!==n&&void 0!==a,...l})};function w(e,n){let{projectRef:t,connectionString:a,tableId:o,...s}=n;return e.fetchQuery(p.j.tableRows(t,{table:{id:o},...s}),n=>{let{signal:r}=n;return v({queryClient:e,projectRef:t,connectionString:a,tableId:o,...s},r)})}},22918:(e,n,t)=>{t.d(n,{j:()=>a});let a={tableRows:function(e){let{table:n,roleImpersonationState:t,...a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return["projects",e,"table-rows",null==n?void 0:n.id,"rows",{roleImpersonation:null==t?void 0:t.role,...a}]},tableRowsCount:function(e){let{table:n,...t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return["projects",e,"table-rows",null==n?void 0:n.id,"count",t]},tableRowsAndCount:(e,n)=>["projects",e,"table-rows",n]}},23183:(e,n,t)=>{t.d(n,{gt:()=>f,kd:()=>p});var a=t(64813),o=t(32144),s=t(56947),r=t(76129),i=t(43089),l=t(667),c=t(66628),d=t(15629),u=t(22918),m=t(46144);let p=5e4,g="\nCREATE OR REPLACE FUNCTION pg_temp.count_estimate(\n    query text\n) RETURNS integer LANGUAGE plpgsql AS $$\nDECLARE\n    plan jsonb;\nBEGIN\n    EXECUTE 'EXPLAIN (FORMAT JSON)' || query INTO plan;\n    RETURN plan->0->'Plan'->'Plan Rows';\nEND;\n$$;\n".trim(),h=e=>{var n,t,o;let{table:s,filters:r=[],enforceExactCount:i=!1}=e;if(!s)return"";if(i){let e=new a.Query().from(s.name,null!=(n=s.schema)?n:void 0).count();return r.filter(e=>e.value&&""!==e.value).forEach(n=>{let t=(0,m.b)(s,n);e=e.filter(n.column,n.operator,t)}),"select (".concat(e.toSql().slice(0,-1),"), false as is_estimate;")}{let e=new a.Query().from(s.name,null!=(t=s.schema)?t:void 0).select("*");r.filter(e=>e.value&&""!=e.value).forEach(n=>{let t=(0,m.b)(s,n);e=e.filter(n.column,n.operator,t)});let n=e.toSql(),i=new a.Query().from(s.name,null!=(o=s.schema)?o:void 0).count();r.filter(e=>e.value&&""!=e.value).forEach(e=>{let n=(0,m.b)(s,e);i=i.filter(e.column,e.operator,n)});let l=i.toSql().slice(0,-1);return"\n".concat(g,"\n\nwith approximation as (\n    select reltuples as estimate\n    from pg_class\n    where oid = ").concat(s.id,"\n)\nselect \n  case \n    when estimate = -1 then (select pg_temp.count_estimate('").concat(n.replaceAll("'","''"),"'))\n    when estimate > ").concat(p," then ").concat(r.length>0?"pg_temp.count_estimate('".concat(n.replaceAll("'","''"),"')"):"estimate","\n    else (").concat(l,")\n  end as count,\n  estimate = -1 or estimate > ").concat(p," as is_estimate\nfrom approximation;\n").trim()}};async function _(e,n){var t;let{queryClient:a,projectRef:o,connectionString:s,tableId:u,filters:m,roleImpersonationState:p,enforceExactCount:g}=e,_=await (0,i.Nj)(a,{projectRef:o,connectionString:s,id:u});if(!_)throw Error("Table not found");let f=(0,r.rH)(_),b=(0,l.Nf)(h({table:f,filters:m,enforceExactCount:g}),p),{result:y}=await (0,d.E)({projectRef:o,connectionString:s,sql:b,queryKey:["table-rows-count",f.id],isRoleImpersonationEnabled:(0,c._c)(null==p?void 0:p.role)},n);return{count:y[0].count,is_estimate:null!=(t=y[0].is_estimate)&&t}}let f=function(e){let{projectRef:n,connectionString:t,tableId:a,...r}=e,{enabled:i=!0,...l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=(0,o.jE)();return(0,s.I)(u.j.tableRowsCount(n,{table:{id:a},...r}),e=>{let{signal:o}=e;return _({queryClient:c,projectRef:n,connectionString:t,tableId:a,...r},o)},{enabled:i&&void 0!==n&&void 0!==a,...l})}},24677:(e,n,t)=>{t.d(n,{BA:()=>r,SF:()=>s,yG:()=>p});var a=t(45923),o=t(56421);let s=10240,r=50,i=["text","varchar","char","character varying","character"],l=["json","jsonb"],c=new Set(l),d=new Set([...i,...l,"bytea","xml","hstore","clob","vector","geometry","geography","tsvector","tsquery","daterange","tsrange","tstzrange","numrange","int4range","int8range","cube","ltree","lquery","jsonpath","citext"]),u=e=>{var n;let t=null==(n=e.primary_keys)?void 0:n.map(e=>e.name);return t&&t.length>0?t:e.columns&&e.columns.length>0?[e.columns[0].name]:[]},m=e=>d.has(e.toLowerCase()),p=e=>{let{table:n,filters:t=[],sorts:l=[],page:d,limit:p,maxCharacters:g=s,maxArraySize:h=r}=e;if(!n||!n.columns)return"";let _=new o.X().from(n.name,n.schema).select();t.forEach(e=>{var t;let a=null==(t=n.columns)?void 0:t.find(n=>n.name===e.column),o=!a||i.includes(a.format);_=_.filter(e.column,e.operator,o||""!==e.value?e.value:null)});let f=n.live_rows_estimate||0;if(0===l.length&&f<=1e5&&n.columns.length>0){let e=u(n);e.length>0&&e.forEach(e=>{_=_.order(n.name,e)})}else l.forEach(e=>{_=_.order(e.table,e.column,e.ascending,e.nullsFirst)});let{from:b,to:y}=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,t=e?e*n:0;return{from:t,to:e?t+n-1:n-1}}((null!=d?d:1)-1,p),v="with _base_query as (".concat(_.range(b,y).toSql({isCTE:!1,isFinal:!1}),")"),x=n.columns.sort((e,n)=>e.ordinal_position-n.ordinal_position).map(e=>({name:e.name,format:e.format.toLowerCase()})),w=n.columns.filter(e=>m(e.format)).map(e=>e.name),j=x.map(e=>{let{name:n}=e,t=(0,a.bD)(n);return w.includes(n)?"case\n        when octet_length(".concat(t,"::text) > ").concat(g," \n        then left(").concat(t,"::text, ").concat(g,") || '...'\n        else ").concat(t,"::text\n      end as ").concat(t):t});n.columns.filter(e=>"array"===e.data_type.toLowerCase()).map(e=>({name:e.name,format:e.format.toLowerCase().slice(1)})).forEach(e=>{let{name:n,format:t}=e,o=j.findIndex(e=>e===(0,a.bD)(n)),s=c.has(t)?"".concat(t,"[]"):"text[]",r="text[]"===s?"array['...']":"array['{\"truncated\": true}'::json]";o>=0&&(j[o]="\n        case \n          when octet_length(".concat((0,a.bD)(n),"::text) > ").concat(g," \n          then\n            case\n              when array_ndims(").concat((0,a.bD)(n),") = 1\n              then\n                (select array_cat(").concat((0,a.bD)(n),"[1:").concat(h,"]::").concat(s,", ").concat(r,"::").concat(s,"))::").concat(s,"\n              else\n                ").concat((0,a.bD)(n),"[1:").concat(h,"]::").concat(s,"\n            end\n          else ").concat((0,a.bD)(n),"::").concat(s,"\n        end\n      "))});let q=j.join(","),E=new o.X().from("_base_query").select(q);return"".concat(v,"\n  ").concat(E.toSql({isCTE:!0,isFinal:!0}))}},43089:(e,n,t)=>{t.d(n,{Ap:()=>l,Nj:()=>d,Pk:()=>c});var a=t(56947),o=t(15629),s=t(9082),r=t(26616),i=t.n(r);async function l(e,n){var t,a;let{projectRef:s,connectionString:r,id:l}=e;if(!l)throw Error("id is required");let c=l?i()("\n    with base_table_info as (\n        select \n            c.oid::int8 as id,\n            nc.nspname as schema,\n            c.relname as name,\n            c.relkind,\n            c.relrowsecurity as rls_enabled,\n            c.relforcerowsecurity as rls_forced,\n            c.relreplident,\n            c.relowner,\n            obj_description(c.oid) as comment\n        from pg_class c\n        join pg_namespace nc on nc.oid = c.relnamespace\n        where c.oid = ".concat(l,"\n            and not pg_is_other_temp_schema(nc.oid)\n            and (\n                pg_has_role(c.relowner, 'USAGE')\n                or has_table_privilege(\n                    c.oid,\n                    'SELECT, INSERT, UPDATE, DELETE, TRUNCATE, REFERENCES, TRIGGER'\n                )\n                or has_any_column_privilege(c.oid, 'SELECT, INSERT, UPDATE, REFERENCES')\n            )\n    ),\n    table_stats as (\n        select \n            b.id,\n            case\n                when b.relreplident = 'd' then 'DEFAULT'\n                when b.relreplident = 'i' then 'INDEX'\n                when b.relreplident = 'f' then 'FULL'\n                else 'NOTHING'\n            end as replica_identity,\n            pg_total_relation_size(format('%I.%I', b.schema, b.name))::int8 as bytes,\n            pg_size_pretty(pg_total_relation_size(format('%I.%I', b.schema, b.name))) as size,\n            pg_stat_get_live_tuples(b.id) as live_rows_estimate,\n            pg_stat_get_dead_tuples(b.id) as dead_rows_estimate\n        from base_table_info b\n        where b.relkind in ('r', 'p')\n    ),\n    primary_keys as (\n        select \n            i.indrelid as table_id,\n            jsonb_agg(jsonb_build_object(\n                'schema', n.nspname,\n                'table_name', c.relname,\n                'table_id', i.indrelid::int8,\n                'name', a.attname\n            )) as primary_keys\n        from pg_index i\n        join pg_class c on i.indrelid = c.oid\n        join pg_attribute a on (a.attrelid = c.oid and a.attnum = any(i.indkey))\n        join pg_namespace n on c.relnamespace = n.oid\n        where i.indisprimary\n        group by i.indrelid\n    ),\n    relationships as (\n        select \n            c.conrelid as source_id,\n            c.confrelid as target_id,\n            jsonb_build_object(\n                'id', c.oid::int8,\n                'constraint_name', c.conname,\n                'deletion_action', c.confdeltype,\n                'update_action', c.confupdtype,\n                'source_schema', nsa.nspname,\n                'source_table_name', csa.relname,\n                'source_column_name', sa.attname,\n                'target_table_schema', nta.nspname,\n                'target_table_name', cta.relname,\n                'target_column_name', ta.attname\n            ) as rel_info\n        from pg_constraint c\n        join pg_class csa on c.conrelid = csa.oid\n        join pg_namespace nsa on csa.relnamespace = nsa.oid\n        join pg_attribute sa on (sa.attrelid = c.conrelid and sa.attnum = any(c.conkey))\n        join pg_class cta on c.confrelid = cta.oid\n        join pg_namespace nta on cta.relnamespace = nta.oid\n        join pg_attribute ta on (ta.attrelid = c.confrelid and ta.attnum = any(c.confkey))\n        where c.contype = 'f'\n    ),\n    columns as (\n        select \n            a.attrelid as table_id,\n            jsonb_agg(jsonb_build_object(\n                'id', (a.attrelid || '.' || a.attnum),\n                'table_id', c.oid::int8,\n                'schema', nc.nspname,\n                'table', c.relname,\n                'ordinal_position', a.attnum,\n                'name', a.attname,\n                'default_value', case \n                    when a.atthasdef then pg_get_expr(ad.adbin, ad.adrelid)\n                    else null\n                end,\n                'data_type', case \n                    when t.typtype = 'd' then \n                        case \n                            when bt.typelem <> 0::oid and bt.typlen = -1 then 'ARRAY'\n                            when nbt.nspname = 'pg_catalog' then format_type(t.typbasetype, null)\n                            else 'USER-DEFINED'\n                        end\n                    else \n                        case \n                            when t.typelem <> 0::oid and t.typlen = -1 then 'ARRAY'\n                            when nt.nspname = 'pg_catalog' then format_type(a.atttypid, null)\n                            else 'USER-DEFINED'\n                        end\n                end,\n                'format', case\n                    when t.typtype = 'e' then\n                        case\n                            when nt.nspname <> 'public' then concat(nt.nspname, '.', coalesce(bt.typname, t.typname))\n                            else coalesce(bt.typname, t.typname)\n                        end\n                    else\n                        coalesce(bt.typname, t.typname)\n                end,\n                'is_identity', a.attidentity in ('a', 'd'),\n                'identity_generation', case a.attidentity\n                    when 'a' then 'ALWAYS'\n                    when 'd' then 'BY DEFAULT'\n                    else null\n                end,\n                'is_generated', a.attgenerated in ('s'),\n                'is_nullable', not (a.attnotnull or t.typtype = 'd' and t.typnotnull),\n                'is_updatable', (\n                    b.relkind in ('r', 'p') or \n                    (b.relkind in ('v', 'f') and pg_column_is_updatable(b.id, a.attnum, false))\n                ),\n                'is_unique', uniques.table_id is not null,\n                'check', check_constraints.definition,\n                'comment', col_description(c.oid, a.attnum),\n                'enums', coalesce(\n                    (\n                        select jsonb_agg(e.enumlabel order by e.enumsortorder)\n                        from pg_catalog.pg_enum e\n                        where e.enumtypid = coalesce(bt.oid, t.oid)\n                            or e.enumtypid = coalesce(bt.typelem, t.typelem)\n                    ),\n                    '[]'::jsonb\n                )\n            ) order by a.attnum) as columns\n        from pg_attribute a\n        join base_table_info b on a.attrelid = b.id\n        join pg_class c on a.attrelid = c.oid\n        join pg_namespace nc on c.relnamespace = nc.oid\n        left join pg_attrdef ad on (a.attrelid = ad.adrelid and a.attnum = ad.adnum)\n        join pg_type t on a.atttypid = t.oid\n        join pg_namespace nt on t.typnamespace = nt.oid\n        left join pg_type bt on (t.typtype = 'd' and t.typbasetype = bt.oid)\n        left join pg_namespace nbt on bt.typnamespace = nbt.oid\n        left join (\n            select \n                conrelid as table_id,\n                conkey[1] as ordinal_position\n            from pg_catalog.pg_constraint\n            where contype = 'u' and cardinality(conkey) = 1\n            group by conrelid, conkey[1]\n        ) as uniques on uniques.table_id = a.attrelid and uniques.ordinal_position = a.attnum\n        left join (\n            select distinct on (conrelid, conkey[1])\n                conrelid as table_id,\n                conkey[1] as ordinal_position,\n                substring(\n                    pg_get_constraintdef(oid, true),\n                    8,\n                    length(pg_get_constraintdef(oid, true)) - 8\n                ) as definition\n            from pg_constraint\n            where contype = 'c' and cardinality(conkey) = 1\n            order by conrelid, conkey[1], oid asc\n        ) as check_constraints on check_constraints.table_id = a.attrelid \n                            and check_constraints.ordinal_position = a.attnum\n        where a.attnum > 0 \n        and not a.attisdropped\n        group by a.attrelid\n    )\n    select \n        case b.relkind\n            when 'r' then jsonb_build_object(\n                'entity_type', b.relkind,\n                'id', b.id,\n                'schema', b.schema,\n                'name', b.name,\n                'rls_enabled', b.rls_enabled,\n                'rls_forced', b.rls_forced,\n                'replica_identity', ts.replica_identity,\n                'bytes', ts.bytes,\n                'size', ts.size,\n                'live_rows_estimate', ts.live_rows_estimate,\n                'dead_rows_estimate', ts.dead_rows_estimate,\n                'comment', b.comment,\n                'primary_keys', coalesce(pk.primary_keys, '[]'::jsonb),\n                'relationships', coalesce(\n                    (select jsonb_agg(r.rel_info)\n                    from relationships r\n                    where r.source_id = b.id or r.target_id = b.id), \n                    '[]'::jsonb\n                ),\n                'columns', coalesce(c.columns, '[]'::jsonb)\n            )\n            when 'p' then jsonb_build_object(\n                'entity_type', b.relkind,\n                'id', b.id,\n                'schema', b.schema,\n                'name', b.name,\n                'rls_enabled', b.rls_enabled,\n                'rls_forced', b.rls_forced,\n                'replica_identity', ts.replica_identity,\n                'bytes', ts.bytes,\n                'size', ts.size,\n                'live_rows_estimate', ts.live_rows_estimate,\n                'dead_rows_estimate', ts.dead_rows_estimate,\n                'comment', b.comment,\n                'primary_keys', coalesce(pk.primary_keys, '[]'::jsonb),\n                'relationships', coalesce(\n                    (select jsonb_agg(r.rel_info)\n                    from relationships r\n                    where r.source_id = b.id or r.target_id = b.id), \n                    '[]'::jsonb\n                ),\n                'columns', coalesce(c.columns, '[]'::jsonb)\n            )\n            when 'v' then jsonb_build_object(\n                'entity_type', b.relkind,\n                'id', b.id,\n                'schema', b.schema,\n                'name', b.name,\n                'is_updatable', (pg_relation_is_updatable(b.id, false) & 20) = 20,\n                'comment', b.comment,\n                'columns', coalesce(c.columns, '[]'::jsonb)\n            )\n            when 'm' then jsonb_build_object(\n                'entity_type', b.relkind,\n                'id', b.id,\n                'schema', b.schema,\n                'name', b.name,\n                'is_populated', true,\n                'comment', b.comment,\n                'columns', coalesce(c.columns, '[]'::jsonb)\n            )\n            when 'f' then jsonb_build_object(\n                'entity_type', b.relkind,\n                'id', b.id,\n                'schema', b.schema,\n                'name', b.name,\n                'comment', b.comment,\n                'columns', coalesce(c.columns, '[]'::jsonb)\n            )\n        end as entity\n    from base_table_info b\n    left join table_stats ts on b.id = ts.id\n    left join primary_keys pk on b.id = pk.table_id\n    left join columns c on b.id = c.table_id;\n  ")):"",{result:d}=await (0,o.E)({projectRef:s,connectionString:r,sql:c,queryKey:["table-editor",l]},n);return null!=(a=null==(t=d[0])?void 0:t.entity)?a:void 0}let c=function(e){let{projectRef:n,connectionString:t,id:o}=e,{enabled:r=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.I)(s.i.tableEditor(n,o),e=>{let{signal:a}=e;return l({projectRef:n,connectionString:t,id:o},a)},{enabled:r&&void 0!==n&&void 0!==o&&!isNaN(o),refetchOnWindowFocus:!1,refetchOnMount:!1,staleTime:3e5,...i})};function d(e,n){let{projectRef:t,connectionString:a,id:o}=n;return e.fetchQuery(s.i.tableEditor(t,o),e=>{let{signal:n}=e;return l({projectRef:t,connectionString:a,id:o},n)})}},46144:(e,n,t)=>{t.d(n,{b:()=>s,j:()=>r});var a=t(96843),o=t(41728);function s(e,n){let t=e.columns.find(e=>e.name==n.column);if(t&&(0,a.n0)(t.format)){let e=Number(n.value);if(!Number.isNaN(e)&&!(e>Number.MAX_SAFE_INTEGER))return Number(n.value)}return n.value}function r(e){let{table:n}=e;if(!(0,o.KO)(n))return{error:{message:"Only table rows can be updated or deleted"}};let t=n.primary_keys;return t&&0!=t.length?{primaryKeys:t.map(e=>e.name)}:{error:{message:"Please add a primary key column to your table to update or delete rows"}}}},48054:(e,n,t)=>{t.d(n,{m:()=>a});let a={create:()=>["queues","create"],delete:e=>["queues",e,"delete"],purge:e=>["queues",e,"purge"],getMessagesInfinite:(e,n,t)=>["projects",e,"queue-messages",n,t].filter(Boolean),list:e=>["projects",e,"queues"],metrics:(e,n)=>["projects",e,"queue-metrics",n],exposePostgrestStatus:e=>["projects",e,"queue-expose-status"]}},56776:(e,n,t)=>{t.d(n,{$O:()=>u,BQ:()=>g,Uu:()=>p});var a=t(74722),o=t.n(a),s=t(53239),r=t(23229),i=t(3914),l=t(98832),c=t(5043),d=t(12006);let u=["auth","cron","extensions","information_schema","net","pgsodium","pgsodium_masks","pgbouncer","pgtle","realtime","storage","supabase_functions","supabase_migrations","vault","graphql","graphql_public",c.Lh],m=()=>{let{project:e}=(0,l.Om)(),n=(0,d.ov)({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString}),t=(0,s.useMemo)(()=>{var e;let t=null==(e=n.data)?void 0:e.filter(e=>(0,i.vN)({handlerName:r.U.ICEBERG,server:{options:[]}},e)),a=null==t?void 0:t.map(e=>(0,i.WV)(e.server_options)).map(e=>e.supabase_target_schema).flatMap(e=>null==e?void 0:e.split(",")).filter(Boolean);return o()(a)},[n.data]);return{...n,data:t}},p=function(){let{excludeSchemas:e=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,s.useMemo)(()=>e,[JSON.stringify(e)]),t=m(),a=(0,s.useMemo)(()=>{var e;let a=u.map(e=>({name:e,type:"internal"})),s=null==(e=t.data)?void 0:e.map(e=>({name:e,type:"fdw"}));return o()([...a,...s]).filter(e=>!n.includes(e.name))},[t.data,n]);return{...t,data:a}},g=e=>{let{schema:n,excludedSchemas:t=[]}=e,{data:a}=p({excludeSchemas:t}),o=a.find(e=>e.name===n);return o?{isSchemaLocked:!0,reason:o.type}:{isSchemaLocked:!1,reason:void 0}}},88338:(e,n,t)=>{t.d(n,{li:()=>h,q3:()=>g,tv:()=>_});var a=t(80263),o=t(32144),s=t(24400),r=t(53239),i=t(76129),l=t(98832),c=t(43089),d=t(15713),u=t(66628),m=t(79033),p=t(44187);function g(e){let{queryClient:n,projectRef:t,connectionString:a,id:o,sorts:s,filters:r,roleImpersonationState:l}=e;return(0,c.Nj)(n,{projectRef:t,connectionString:a,id:o}).then(e=>{if(e){var c;let u=(0,i.rH)(e),{sorts:p=[],filters:g=[]}=null!=(c=(0,i.Tk)(t,e.name,e.schema))?c:{};(0,d.nk)(n,{projectRef:t,connectionString:a,tableId:o,sorts:null!=s?s:(0,i.FU)(u.name,p),filters:null!=r?r:(0,i.hl)(g),page:1,limit:m.to,roleImpersonationState:l})}})}function h(){let e=(0,s.useRouter)(),n=(0,o.jE)(),{project:t}=(0,l.Om)(),a=(0,u.RY)();return(0,r.useCallback)(o=>{let{id:s,filters:r,sorts:i}=o,l=s?Number(s):void 0;!t||!l||isNaN(l)||(e.prefetch("/project/".concat(t.ref,"/editor/").concat(l)),g({queryClient:n,projectRef:t.ref,connectionString:t.connectionString,id:l,sorts:i,filters:r,roleImpersonationState:a}).catch(()=>{}))},[t,n,a,e])}function _(e){let{projectRef:n,id:t,sorts:o,filters:s,href:r,children:i,...l}=e,c=h();return(0,a.jsx)(p.A,{href:r||"/project/".concat(n,"/editor/").concat(t),prefetcher:()=>c({id:t,sorts:o,filters:s}),...l,"data-sentry-element":"PrefetchableLink","data-sentry-component":"EditorTablePageLink","data-sentry-source-file":"project.$ref.editor.$id.tsx",children:i})}},91746:(e,n,t)=>{t.d(n,{i:()=>u});var a=t(80263),o=t(53239),s=t(16838),r=t(40022),i=t(51500),l=t(56776),c=t(47142);let d=e=>{let{onClose:n}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.c7,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:(0,a.jsx)(s.L3,{"data-sentry-element":"DialogTitle","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:"Schemas managed by Supabase"})}),(0,a.jsx)(s.pf,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"ProtectedSchemaWarning.tsx"}),(0,a.jsxs)(s.OO,{className:"space-y-2 prose","data-sentry-element":"DialogSection","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:[(0,a.jsx)("p",{className:"text-sm",children:"The following schemas are managed by Supabase and are currently protected from write access through the dashboard."}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:l.$O.map(e=>(0,a.jsx)("code",{className:"text-xs",children:e},e))}),(0,a.jsx)("p",{className:"text-sm !mt-4",children:"These schemas are critical to the functionality of your Supabase project and hence we highly recommend not altering them."}),(0,a.jsx)("p",{className:"text-sm",children:"You can, however, still interact with those schemas through the SQL Editor although we advise you only do so if you know what you are doing."})]}),(0,a.jsx)(s.Es,{"data-sentry-element":"DialogFooter","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:(0,a.jsx)("div",{className:"flex items-center justify-end space-x-2",children:(0,a.jsx)(r.$,{type:"default",onClick:n,"data-sentry-element":"Button","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:"Understood"})})})]})},u=e=>{let{size:n="md",schema:t,entity:u}=e,[m,p]=(0,o.useState)(!1),{isSchemaLocked:g,reason:h}=(0,l.BQ)({schema:t});return g?(0,a.jsx)(c.Z,{showIcon:!1,type:"note",title:"sm"===n?"Viewing protected schema":"Viewing ".concat(u," from a protected schema"),className:(0,i.cn)("[&>div>p]:prose [&>div>p]:max-w-full [&>div>p]:!leading-normal","sm"===n?"[&>div>p]:text-xs":"[&>div>p]:text-sm"),"data-sentry-element":"Admonition","data-sentry-component":"ProtectedSchemaWarning","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:"fdw"===h?(0,a.jsxs)("p",{children:["The ",(0,a.jsx)("code",{className:"text-xs",children:t})," schema is used by Supabase to connect to analytics buckets and is read-only through the dashboard."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("p",{className:"mb-2",children:["The ",(0,a.jsx)("code",{className:"text-xs",children:t})," schema is managed by Supabase and is read-only through the dashboard."]}),(0,a.jsxs)(s.lG,{open:m,onOpenChange:p,children:[(0,a.jsx)(s.zM,{asChild:!0,children:(0,a.jsx)(r.$,{type:"default",size:"tiny",onClick:()=>p(!0),children:"Learn more"})}),(0,a.jsx)(s.Cf,{children:(0,a.jsx)(d,{onClose:()=>p(!1)})})]})]})}):null}},96843:(e,n,t)=>{t.d(n,{AM:()=>w,I:()=>b,KV:()=>g,Lj:()=>r,_c:()=>m,ao:()=>l,cx:()=>d,e2:()=>E,hB:()=>_,n0:()=>o,th:()=>v,yB:()=>q});let a=["smallint","integer","bigint","decimal","numeric","real","double precision","serial","bigserial","int2","int4","int8","float4","float8","smallserial","serial2","serial4","serial8"];function o(e){return a.indexOf(e.toLowerCase())>-1}let s=["json","jsonb","array"];function r(e){return s.indexOf(e.toLowerCase())>-1}let i=["array"];function l(e){return i.indexOf(e.toLowerCase())>-1}let c=["uuid","text","character varying"];function d(e){return c.indexOf(e.toLowerCase())>-1}let u=["citext"];function m(e){return u.indexOf(e.toLowerCase())>-1}let p=["timestamp","timestamptz"];function g(e){return p.indexOf(e.toLowerCase())>-1}let h=["date"];function _(e){return h.indexOf(e.toLowerCase())>-1}let f=["time","timetz"];function b(e){return f.indexOf(e.toLowerCase())>-1}let y=["boolean","bool"];function v(e){return y.indexOf(e.toLowerCase())>-1}let x=["user-defined"];function w(e){return x.indexOf(e.toLowerCase())>-1}let j=["bytea"];function q(e){return j.indexOf(e.toLowerCase())>-1}function E(e){var n;let{targetTableSchema:t,targetTableName:a,targetColumnName:o}=null!=(n=null==e?void 0:e.foreignKey)?n:{};return!!t&&!!a&&!!o}}}]);